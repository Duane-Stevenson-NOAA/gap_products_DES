<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GAP Production Data Documentation - 12&nbsp; Access via API and R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../content/foss-api-py.html" rel="next">
<link href="../content/foss-platform.html" rel="prev">
<link href="../img/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script>



</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/foss-intro.html">Public Data (FOSS)</a></li><li class="breadcrumb-item"><a href="../content/foss-api-r.html"><span class="chapter-title">Access via API and R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="https://avatars.githubusercontent.com/u/91760178?s=96&amp;amp;v=4" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">GAP Production Data Documentation</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/afsc-gap-products" title="AFSC GAP Survey Data Products" class="quarto-navigation-tool px-1" aria-label="AFSC GAP Survey Data Products"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/afsc-gap-products/gap_products" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../GAP-Production-Data-Documentation.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../GAP-Production-Data-Documentation.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/intro-survey-background.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Survey Background</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/intro-workflow.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/intro-news.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">News</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/intro-code-of-conduct.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Code of Conduct</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../content/product-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GAP Production Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/product-metadata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Data description</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/product-metadata-column.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Universal Column Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../content/akfin-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AKFIN</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/akfin-metadata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Data description</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/akfin-oracle-sql-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access data via Oracle and R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/akfin-api-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access API data via R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../content/foss-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Public Data (FOSS)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/foss-metadata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Data description</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/foss-platform.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Using the FOSS platform</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/foss-api-r.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Access via API and R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/foss-api-py.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access via API and Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/foss-oracle-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access via Oracle and R (AFSC Staff only)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../content/other-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Products &amp; Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/other-pkgs.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Open source code</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../content/end-contact-us.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contact us</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/end-run-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Production run notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/end-acknowledgements.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Acknowledgments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/end-refs.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ex.-load-all-rows-of-the-catch-haul-and-species-data-tables" id="toc-ex.-load-all-rows-of-the-catch-haul-and-species-data-tables" class="nav-link active" data-scroll-target="#ex.-load-all-rows-of-the-catch-haul-and-species-data-tables"><span class="header-section-number">13</span> Ex. Load all rows of the catch, haul, and species data tables</a>
  <ul class="collapse">
  <li><a href="#load-haul-data" id="toc-load-haul-data" class="nav-link" data-scroll-target="#load-haul-data"><span class="header-section-number">13.1</span> Load haul data</a>
  <ul class="collapse">
  <li><a href="#load-first-25-rows-of-data" id="toc-load-first-25-rows-of-data" class="nav-link" data-scroll-target="#load-first-25-rows-of-data"><span class="header-section-number">13.1.1</span> Load first 25 rows of data</a></li>
  <li><a href="#load-all-data" id="toc-load-all-data" class="nav-link" data-scroll-target="#load-all-data"><span class="header-section-number">13.1.2</span> Load all data:</a></li>
  </ul></li>
  <li><a href="#load-catch-data" id="toc-load-catch-data" class="nav-link" data-scroll-target="#load-catch-data"><span class="header-section-number">13.2</span> Load catch data</a>
  <ul class="collapse">
  <li><a href="#load-first-25-rows-of-data-1" id="toc-load-first-25-rows-of-data-1" class="nav-link" data-scroll-target="#load-first-25-rows-of-data-1"><span class="header-section-number">13.2.1</span> Load first 25 rows of data</a></li>
  <li><a href="#load-all-data-1" id="toc-load-all-data-1" class="nav-link" data-scroll-target="#load-all-data-1"><span class="header-section-number">13.2.2</span> Load all data</a></li>
  </ul></li>
  <li><a href="#load-species-data" id="toc-load-species-data" class="nav-link" data-scroll-target="#load-species-data"><span class="header-section-number">13.3</span> Load species data</a></li>
  </ul></li>
  <li><a href="#ex.-create-zero-filled-data-using-data-loaded-in-last-example" id="toc-ex.-create-zero-filled-data-using-data-loaded-in-last-example" class="nav-link" data-scroll-target="#ex.-create-zero-filled-data-using-data-loaded-in-last-example"><span class="header-section-number">14</span> Ex. Create zero-filled data using data loaded in last example</a></li>
  <li><a href="#ex.-visualize-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-in-cpue-data-in-distribution-map" id="toc-ex.-visualize-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-in-cpue-data-in-distribution-map" class="nav-link" data-scroll-target="#ex.-visualize-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-in-cpue-data-in-distribution-map"><span class="header-section-number">15</span> Ex. Visualize zero-filled data for 2023 eastern Bering Sea walleye pollock in CPUE data in distribution map</a>
  <ul class="collapse">
  <li><a href="#plot-locations-on-map" id="toc-plot-locations-on-map" class="nav-link" data-scroll-target="#plot-locations-on-map"><span class="header-section-number">15.0.1</span> Plot locations on map</a></li>
  <li><a href="#plot-inverse-distance-weighted-plot-of-cpue" id="toc-plot-inverse-distance-weighted-plot-of-cpue" class="nav-link" data-scroll-target="#plot-inverse-distance-weighted-plot-of-cpue"><span class="header-section-number">15.1</span> Plot inverse-distance weighted plot of CPUE</a></li>
  </ul></li>
  <li><a href="#ex.-show-catch-data-for-2023-eastern-bering-sea-walleye-pollock-one-species-in-one-survey-region-in-one-year" id="toc-ex.-show-catch-data-for-2023-eastern-bering-sea-walleye-pollock-one-species-in-one-survey-region-in-one-year" class="nav-link" data-scroll-target="#ex.-show-catch-data-for-2023-eastern-bering-sea-walleye-pollock-one-species-in-one-survey-region-in-one-year"><span class="header-section-number">16</span> Ex. Show catch data for 2023 eastern Bering Sea Walleye Pollock (one species in one survey region in one year)</a>
  <ul class="collapse">
  <li><a href="#identify-species_code-for-walleye-pollock" id="toc-identify-species_code-for-walleye-pollock" class="nav-link" data-scroll-target="#identify-species_code-for-walleye-pollock"><span class="header-section-number">16.1</span> Identify <code>species_code</code> for walleye pollock</a></li>
  <li><a href="#then-apply-the-hauljoins-and-species_code-to-catch-query" id="toc-then-apply-the-hauljoins-and-species_code-to-catch-query" class="nav-link" data-scroll-target="#then-apply-the-hauljoins-and-species_code-to-catch-query"><span class="header-section-number">16.2</span> Then, apply the <code>hauljoins</code> and <code>species_code</code> to catch query</a></li>
  <li><a href="#create-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-and-plot" id="toc-create-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-and-plot" class="nav-link" data-scroll-target="#create-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-and-plot"><span class="header-section-number">16.3</span> Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot</a></li>
  <li><a href="#visualize-cpue-data-in-distribution-map" id="toc-visualize-cpue-data-in-distribution-map" class="nav-link" data-scroll-target="#visualize-cpue-data-in-distribution-map"><span class="header-section-number">16.4</span> Visualize CPUE data in distribution map</a></li>
  <li><a href="#plot-locations" id="toc-plot-locations" class="nav-link" data-scroll-target="#plot-locations"><span class="header-section-number">16.5</span> Plot locations</a></li>
  <li><a href="#plot-inverse-distance-weighted-modeled-product-of-locations" id="toc-plot-inverse-distance-weighted-modeled-product-of-locations" class="nav-link" data-scroll-target="#plot-inverse-distance-weighted-modeled-product-of-locations"><span class="header-section-number">16.6</span> Plot inverse-distance weighted modeled product of locations</a></li>
  </ul></li>
  <li><a href="#other-query-examples" id="toc-other-query-examples" class="nav-link" data-scroll-target="#other-query-examples"><span class="header-section-number">17</span> Other query examples</a>
  <ul class="collapse">
  <li><a href="#ex.-combination-of-year-srvy-stratum" id="toc-ex.-combination-of-year-srvy-stratum" class="nav-link" data-scroll-target="#ex.-combination-of-year-srvy-stratum"><span class="header-section-number">17.1</span> Ex. Combination of year, srvy, stratum</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/afsc-gap-products/gap_products/edit/main/content/foss-api-r.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/afsc-gap-products/gap_products/blob/main/content/foss-api-r.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/afsc-gap-products/gap_products/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div id="google_translate_element"></div>



<script type="text/javascript">

function googleTranslateElementInit() {

  new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');

}

</script>



<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/foss-intro.html">Public Data (FOSS)</a></li><li class="breadcrumb-item"><a href="../content/foss-api-r.html"><span class="chapter-title">Access via API and R</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Access via API and R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>An application programming interface (API) is a way for two or more computer programs to communicate with each other.</strong> More information about how to amend API links can be found <a href="https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/22.3/books.html#AELIG90103/">here</a>. Useful introductions to using APIs in <code>R</code> can be found <a href="https://www.dataquest.io/blog/r-api-tutorial/">here</a>.</p>
<p>There are three tables the user can pull from the API. Learn more about them on the <a href="https://afsc-gap-products.github.io/gap_products/content/foss-metadata.html">FOSS data description page</a>. Here, you can see them in their raw JSON format:</p>
<ul>
<li>haul: <a href="https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/">https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/</a></li>
<li>catch: <a href="https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/">https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/</a></li>
<li>species: <a href="https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/">https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/</a></li>
</ul>
<p>Here are some examples of how to use the data with R:</p>
<section id="ex.-load-all-rows-of-the-catch-haul-and-species-data-tables" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Ex. Load all rows of the catch, haul, and species data tables</h1>
<p>Note that without specifying, a basic query to the API will only return 25 entries.</p>
<section id="load-haul-data" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="load-haul-data"><span class="header-section-number">13.1</span> Load haul data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># link to the API</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>api_link_haul <span class="ot">&lt;-</span> <span class="st">'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-first-25-rows-of-data" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="load-first-25-rows-of-data"><span class="header-section-number">13.1.1</span> Load first 25 rows of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> api_link_haul)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># res ## Test connection</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## convert from JSON format</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content))<span class="sc">$</span>items</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find how many rows and columns are in the data pull</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 25; cols: 28"</code></pre>
</div>
</div>
</section>
<section id="load-all-data" class="level3" data-number="13.1.2">
<h3 data-number="13.1.2" class="anchored" data-anchor-id="load-all-data"><span class="header-section-number">13.1.2</span> Load all data:</h3>
<p>Since the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by <code>offsetting</code> to the next 10,000 rows (as is shown here).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">500000</span>, <span class="dv">10000</span>)){</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## find how many iterations it takes to cycle through the data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## query the API link</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_haul, <span class="st">"?offset="</span>,i,<span class="st">"&amp;limit=10000"</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## convert from JSON format</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content)) </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## if there are no data, stop the loop</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(<span class="fu">nrow</span>(data<span class="sc">$</span>items))) {</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## bind sub-pull to dat data.frame</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(dat, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                          data<span class="sc">$</span>items <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links)) <span class="co"># necessary for API accounting, but not part of the dataset)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0
[1] 10000
[1] 20000
[1] 30000
[1] 40000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few lines of the data </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-316efcee{}.cl-315ade30{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-315ade4e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-31626074{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3162607e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3162a20a{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3162a214{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3162a21e{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3162a228{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3162a232{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3162a23c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-316efcee"><caption><p>First few rows of haul data.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">year</span></p></th><th class="cl-3162a214"><p class="cl-3162607e"><span class="cl-315ade30">srvy</span></p></th><th class="cl-3162a214"><p class="cl-3162607e"><span class="cl-315ade30">survey</span></p></th><th class="cl-3162a214"><p class="cl-3162607e"><span class="cl-315ade30">survey_name</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">survey_definition_id</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">cruise</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">cruisejoin</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">hauljoin</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">haul</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">stratum</span></p></th><th class="cl-3162a214"><p class="cl-3162607e"><span class="cl-315ade30">station</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">vessel_id</span></p></th><th class="cl-3162a214"><p class="cl-3162607e"><span class="cl-315ade30">vessel_name</span></p></th><th class="cl-3162a214"><p class="cl-3162607e"><span class="cl-315ade30">date_time</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">latitude_dd_start</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">longitude_dd_start</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">latitude_dd_end</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">longitude_dd_end</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">bottom_temperature_c</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">surface_temperature_c</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">depth_m</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">distance_fished_km</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">duration_hr</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">net_width_m</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">net_height_m</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">area_swept_km2</span></p></th><th class="cl-3162a20a"><p class="cl-31626074"><span class="cl-315ade30">performance</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">1998</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">EBS</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">eastern Bering Sea</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">98</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">199801</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">937213</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">937,531</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">125</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">41</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">J-23</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">89</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">ALDEBARAN</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">1998-07-13T11:29:00Z</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">57.99293</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">-171.5905</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">58.01870</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">-171.5921</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">3.0</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">7.9</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">98</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">2.869</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">0.52</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">18.360</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">1.840</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">0.052675</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">1998</span></p></td><td class="cl-3162a23c"><p class="cl-3162607e"><span class="cl-315ade4e">EBS</span></p></td><td class="cl-3162a23c"><p class="cl-3162607e"><span class="cl-315ade4e">eastern Bering Sea</span></p></td><td class="cl-3162a23c"><p class="cl-3162607e"><span class="cl-315ade4e">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">98</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">199801</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">937213</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">937,532</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">126</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">42</span></p></td><td class="cl-3162a23c"><p class="cl-3162607e"><span class="cl-315ade4e">J-22</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">89</span></p></td><td class="cl-3162a23c"><p class="cl-3162607e"><span class="cl-315ade4e">ALDEBARAN</span></p></td><td class="cl-3162a23c"><p class="cl-3162607e"><span class="cl-315ade4e">1998-07-13T14:12:00Z</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">57.99357</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">-170.9699</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">58.01933</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">-170.9711</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">2.5</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">8.1</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">87</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">2.867</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">0.51</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">18.254</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">1.884</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">0.052334</span></p></td><td class="cl-3162a232"><p class="cl-31626074"><span class="cl-315ade4e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">1998</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">EBS</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">eastern Bering Sea</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">98</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">199801</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">937213</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">937,533</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">127</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">41</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">K-22</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">89</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">ALDEBARAN</span></p></td><td class="cl-3162a228"><p class="cl-3162607e"><span class="cl-315ade4e">1998-07-13T16:41:00Z</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">58.32213</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">-171.0066</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">58.34687</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">-171.0160</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">2.1</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">8.2</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">84</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">2.808</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">0.52</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">18.471</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">1.770</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">0.051867</span></p></td><td class="cl-3162a21e"><p class="cl-31626074"><span class="cl-315ade4e">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year          srvy              survey          survey_name       
 Min.   :1982   Length:33991       Length:33991       Length:33991      
 1st Qu.:1997   Class :character   Class :character   Class :character  
 Median :2006   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2005                                                           
 3rd Qu.:2015                                                           
 Max.   :2024                                                           
                                                                        
 survey_definition_id     cruise         cruisejoin         hauljoin      
 Min.   : 47.00       Min.   :198201   Min.   :   -770   Min.   : -23911  
 1st Qu.: 47.00       1st Qu.:199701   1st Qu.:   -697   1st Qu.: -14104  
 Median : 78.00       Median :200601   Median :   -616   Median :  -4314  
 Mean   : 74.55       Mean   :200543   Mean   : 294616   Mean   : 289722  
 3rd Qu.: 98.00       3rd Qu.:201501   3rd Qu.: 837799   3rd Qu.: 816124  
 Max.   :143.00       Max.   :202401   Max.   :1225395   Max.   :1225635  
                                                                          
      haul          stratum        station            vessel_id    
 Min.   :  1.0   Min.   : 10.0   Length:33991       Min.   :  1.0  
 1st Qu.: 56.0   1st Qu.: 31.0   Class :character   1st Qu.: 88.0  
 Median :112.0   Median : 50.0   Mode  :character   Median : 94.0  
 Mean   :117.3   Mean   :130.9                      Mean   :107.8  
 3rd Qu.:170.0   3rd Qu.:142.0                      3rd Qu.:147.0  
 Max.   :355.0   Max.   :794.0                      Max.   :178.0  
                                                                   
 vessel_name         date_time         latitude_dd_start longitude_dd_start
 Length:33991       Length:33991       Min.   :51.19     Min.   :-180.0    
 Class :character   Class :character   1st Qu.:55.00     1st Qu.:-170.7    
 Mode  :character   Mode  :character   Median :57.16     Median :-165.3    
                                       Mean   :56.86     Mean   :-139.6    
                                       3rd Qu.:58.97     3rd Qu.:-154.4    
                                       Max.   :65.34     Max.   : 180.0    
                                                                           
 latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c
 Min.   :51.19   Min.   :-180.0   Min.   :-2.100       Min.   :-1.100       
 1st Qu.:55.00   1st Qu.:-170.7   1st Qu.: 2.700       1st Qu.: 5.800       
 Median :57.16   Median :-165.3   Median : 4.100       Median : 7.400       
 Mean   :56.86   Mean   :-139.6   Mean   : 3.829       Mean   : 7.794       
 3rd Qu.:58.96   3rd Qu.:-154.4   3rd Qu.: 5.200       3rd Qu.: 9.300       
 Max.   :65.35   Max.   : 180.0   Max.   :15.300       Max.   :18.100       
 NA's   :4       NA's   :4        NA's   :1601         NA's   :852          
    depth_m       distance_fished_km  duration_hr      net_width_m   
 Min.   :   9.0   Min.   :0.135      Min.   :0.0250   Min.   : 7.51  
 1st Qu.:  68.0   1st Qu.:1.497      1st Qu.:0.2710   1st Qu.:15.58  
 Median : 102.0   Median :2.528      Median :0.4900   Median :16.40  
 Mean   : 137.8   Mean   :2.206      Mean   :0.4006   Mean   :16.42  
 3rd Qu.: 156.0   3rd Qu.:2.833      3rd Qu.:0.5090   3rd Qu.:17.21  
 Max.   :1200.0   Max.   :4.334      Max.   :0.9800   Max.   :23.82  
                                                                     
  net_height_m    area_swept_km2      performance    
 Min.   : 0.000   Min.   :0.002314   Min.   :0.0000  
 1st Qu.: 2.383   1st Qu.:0.024261   1st Qu.:0.0000  
 Median : 5.865   Median :0.039562   Median :0.0000  
 Mean   : 4.822   Mean   :0.036378   Mean   :0.2779  
 3rd Qu.: 6.788   3rd Qu.:0.047280   3rd Qu.:0.0000  
 Max.   :11.038   Max.   :0.077795   Max.   :7.0000  
 NA's   :3269                                        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find how many rows and columns are in the data pull</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 33991; cols: 27"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save outputs for later comparison</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dat_haul_api <span class="ot">&lt;-</span> dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="load-catch-data" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="load-catch-data"><span class="header-section-number">13.2</span> Load catch data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># link to the API</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>api_link_catch <span class="ot">&lt;-</span> <span class="st">'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-inlcude="false">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>api_link_catch <span class="ot">&lt;-</span> <span class="st">'https://dev-apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/'</span> <span class="co"># test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-first-25-rows-of-data-1" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="load-first-25-rows-of-data-1"><span class="header-section-number">13.2.1</span> Load first 25 rows of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> api_link_catch)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># res ## Test connection</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">## convert from JSON format</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content))<span class="sc">$</span>items</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find how many rows and columns are in the data pull</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 25; cols: 8"</code></pre>
</div>
</div>
</section>
<section id="load-all-data-1" class="level3" data-number="13.2.2">
<h3 data-number="13.2.2" class="anchored" data-anchor-id="load-all-data-1"><span class="header-section-number">13.2.2</span> Load all data</h3>
<p>Since the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by <code>offsetting</code> to the next 10,000 rows (as is shown here).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in seq(0, 100000, 10000)){</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000000</span>, <span class="dv">10000</span>)){</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## find how many iterations it takes to cycle through the data</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(i)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## query the API link</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_catch, <span class="st">"?offset="</span>,i,<span class="st">"&amp;limit=10000"</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## convert from JSON format</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content)) </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## if there are no data, stop the loop</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(<span class="fu">nrow</span>(data<span class="sc">$</span>items))) {</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## bind sub-pull to dat data.frame</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(dat, </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                          data<span class="sc">$</span>items <span class="sc">%&gt;%</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links)) <span class="co"># necessary for API accounting, but not part of the dataset)</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few lines of the data </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-e724afac{}.cl-e7152640{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e7152654{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e71b2b58{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e71b2b6c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e71b5f38{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e71b5f4c{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e71b5f4d{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e71b5f60{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e71b5f61{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e71b5f6a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e724afac"><caption><p>First few rows of catch data.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-e71b5f38"><p class="cl-e71b2b58"><span class="cl-e7152640">hauljoin</span></p></th><th class="cl-e71b5f38"><p class="cl-e71b2b58"><span class="cl-e7152640">species_code</span></p></th><th class="cl-e71b5f38"><p class="cl-e71b2b58"><span class="cl-e7152640">cpue_kgkm2</span></p></th><th class="cl-e71b5f38"><p class="cl-e71b2b58"><span class="cl-e7152640">cpue_nokm2</span></p></th><th class="cl-e71b5f38"><p class="cl-e71b2b58"><span class="cl-e7152640">count</span></p></th><th class="cl-e71b5f38"><p class="cl-e71b2b58"><span class="cl-e7152640">weight_kg</span></p></th><th class="cl-e71b5f4c"><p class="cl-e71b2b6c"><span class="cl-e7152640">taxon_confidence</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">-20,640</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">69086</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">447.003231</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">4,735.5788</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">214</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">20.200</span></p></td><td class="cl-e71b5f60"><p class="cl-e71b2b6c"><span class="cl-e7152654">High</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e71b5f61"><p class="cl-e71b2b58"><span class="cl-e7152654">-20,640</span></p></td><td class="cl-e71b5f61"><p class="cl-e71b2b58"><span class="cl-e7152654">69095</span></p></td><td class="cl-e71b5f61"><p class="cl-e71b2b58"><span class="cl-e7152654">7.435301</span></p></td><td class="cl-e71b5f61"><p class="cl-e71b2b58"><span class="cl-e7152654">265.5465</span></p></td><td class="cl-e71b5f61"><p class="cl-e71b2b58"><span class="cl-e7152654">12</span></p></td><td class="cl-e71b5f61"><p class="cl-e71b2b58"><span class="cl-e7152654">0.336</span></p></td><td class="cl-e71b5f6a"><p class="cl-e71b2b6c"><span class="cl-e7152654">High</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">-20,640</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">71001</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">33.082665</span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654"></span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654"></span></p></td><td class="cl-e71b5f4d"><p class="cl-e71b2b58"><span class="cl-e7152654">1.495</span></p></td><td class="cl-e71b5f60"><p class="cl-e71b2b6c"><span class="cl-e7152654"></span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    hauljoin        species_code     cpue_kgkm2        cpue_nokm2      
 Min.   : -23911   Min.   :    1   Min.   :      0   Min.   :      13  
 1st Qu.: -14398   1st Qu.:20510   1st Qu.:      6   1st Qu.:      58  
 Median :  -5225   Median :40500   Median :     49   Median :     213  
 Mean   : 281196   Mean   :45121   Mean   :   1253   Mean   :    4618  
 3rd Qu.: 802468   3rd Qu.:71800   3rd Qu.:    375   3rd Qu.:    1134  
 Max.   :1225635   Max.   :99999   Max.   :3226235   Max.   :21780780  
                                                     NA's   :89147     
     count          weight_kg         taxon_confidence  
 Min.   :     1   Min.   :    0.001   Length:890349     
 1st Qu.:     2   1st Qu.:    0.200   Class :character  
 Median :     8   Median :    1.814   Mode  :character  
 Mean   :   181   Mean   :   41.827                     
 3rd Qu.:    43   3rd Qu.:   13.900                     
 Max.   :867119   Max.   :18187.700                     
 NA's   :89147                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find how many rows and columns are in the data pull</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 890349; cols: 7"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save outputs for later comparison</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dat_catch_api <span class="ot">&lt;-</span> dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="load-species-data" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="load-species-data"><span class="header-section-number">13.3</span> Load species data</h2>
<p>Since there are less than 10,000 rows of species data (and the maxim number of rows a user can pull from this API is 10,000 rows in a query), we can simply call <code>?offset=0&amp;limit=10000</code> in our query call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># link to the API</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>api_link_species <span class="ot">&lt;-</span> <span class="st">'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_species, <span class="st">"?offset=0&amp;limit=10000"</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## convert from JSON format</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data<span class="sc">$</span>items  <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links) <span class="co"># necessary for API accounting, but not part of the dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few lines of the data </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data<span class="sc">$</span>items, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-e84b6c86{}.cl-e83b6336{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e83b6340{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e84185fe{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e8418612{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e841bcae{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e841bcc2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e841bcc3{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e841bccc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e841bccd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e841bcd6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e84b6c86"><caption><p>First few rows of species data.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-e841bcae"><p class="cl-e84185fe"><span class="cl-e83b6336">species_code</span></p></th><th class="cl-e841bcc2"><p class="cl-e8418612"><span class="cl-e83b6336">scientific_name</span></p></th><th class="cl-e841bcc2"><p class="cl-e8418612"><span class="cl-e83b6336">common_name</span></p></th><th class="cl-e841bcc2"><p class="cl-e8418612"><span class="cl-e83b6336">id_rank</span></p></th><th class="cl-e841bcae"><p class="cl-e84185fe"><span class="cl-e83b6336">worms</span></p></th><th class="cl-e841bcae"><p class="cl-e84185fe"><span class="cl-e83b6336">itis</span></p></th><th class="cl-e841bcae"><p class="cl-e84185fe"><span class="cl-e83b6336">links</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">10130</span></p></td><td class="cl-e841bccc"><p class="cl-e8418612"><span class="cl-e83b6340">Hippoglossoides elassodon</span></p></td><td class="cl-e841bccc"><p class="cl-e8418612"><span class="cl-e83b6340">flathead sole</span></p></td><td class="cl-e841bccc"><p class="cl-e8418612"><span class="cl-e83b6340">species</span></p></td><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">274289</span></p></td><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">172875</span></p></td><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">[[data.frame]]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e841bccd"><p class="cl-e84185fe"><span class="cl-e83b6340">20731</span></p></td><td class="cl-e841bcd6"><p class="cl-e8418612"><span class="cl-e83b6340">Rathbunella hypoplecta</span></p></td><td class="cl-e841bcd6"><p class="cl-e8418612"><span class="cl-e83b6340">smooth ronquil</span></p></td><td class="cl-e841bcd6"><p class="cl-e8418612"><span class="cl-e83b6340">species</span></p></td><td class="cl-e841bccd"><p class="cl-e84185fe"><span class="cl-e83b6340">282556</span></p></td><td class="cl-e841bccd"><p class="cl-e84185fe"><span class="cl-e83b6340">170954</span></p></td><td class="cl-e841bccd"><p class="cl-e84185fe"><span class="cl-e83b6340">[[data.frame]]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">21308</span></p></td><td class="cl-e841bccc"><p class="cl-e8418612"><span class="cl-e83b6340">Thyriscus anoplus</span></p></td><td class="cl-e841bccc"><p class="cl-e8418612"><span class="cl-e83b6340">sponge sculpin</span></p></td><td class="cl-e841bccc"><p class="cl-e8418612"><span class="cl-e83b6340">species</span></p></td><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">282971</span></p></td><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">167367</span></p></td><td class="cl-e841bcc3"><p class="cl-e84185fe"><span class="cl-e83b6340">[[data.frame]]</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  species_code   scientific_name    common_name          id_rank         
 Min.   :    1   Length:1894        Length:1894        Length:1894       
 1st Qu.:30105   Class :character   Class :character   Class :character  
 Median :70061   Mode  :character   Mode  :character   Mode  :character  
 Mean   :58788                                                           
 3rd Qu.:80543                                                           
 Max.   :99999                                                           
                                                                         
     worms              itis        
 Min.   :     51   Min.   :  46861  
 1st Qu.: 134297   1st Qu.:  79427  
 Median : 254545   Median : 157164  
 Mean   : 314551   Mean   : 210096  
 3rd Qu.: 369147   3rd Qu.: 167414  
 Max.   :1757986   Max.   :1206057  
 NA's   :225       NA's   :389      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find how many rows and columns are in the data pull</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 1894; cols: 6"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save outputs for later comparison</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>dat_species_api <span class="ot">&lt;-</span> dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ex.-create-zero-filled-data-using-data-loaded-in-last-example" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Ex. Create zero-filled data using data loaded in last example</h1>
<p>It is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># come up with full combination of what species should be listed for what hauls/surveys</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for zero-filled data, all species caught in a survey need to have zero or non-zero row entries for a haul</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>comb <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find all species that have been caught, by survey</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(dat_catch_api, dat_haul_api, <span class="at">by =</span> <span class="st">"hauljoin"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(survey_definition_id, species_code) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find all haul events (hauljoins), by survey</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dat_haul_api <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(survey_definition_id, hauljoin) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">relationship =</span> <span class="st">"many-to-many"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"survey_definition_id"</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>survey_definition_id) <span class="co"># redundant</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comb, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  species_code hauljoin
1        69086    -7112
2        69086    -7113
3        69086    -7115</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join data to make a full zero-filled CPUE dataset</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>dat_zerofill_api <span class="ot">&lt;-</span> comb <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add species data to unique species by survey table</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(dat_species_api) <span class="sc">%&gt;%</span> <span class="co"># , "species_code"</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add haul data</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(dat_haul_api) <span class="sc">%&gt;%</span> <span class="co"># , c("hauljoin")</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add catch data</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(dat_catch_api) <span class="sc">%&gt;%</span> <span class="co"># , c("species_code", "hauljoin")</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># modify zero-filled rows</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cpue_kgkm2 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(cpue_kgkm2), <span class="dv">0</span>, cpue_kgkm2),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cpue_nokm2 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(cpue_nokm2), <span class="dv">0</span>, cpue_nokm2),</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(count), <span class="dv">0</span>, count),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_kg =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(weight_kg), <span class="dv">0</span>, weight_kg))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Find how many rows and columns are in the data pull. </span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Because all of the data have been full joined together, </span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="do">## there should be the maximum number of rows. </span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 1894; cols: 6"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">%&gt;%</span> flextable<span class="sc">::</span><span class="fu">theme_zebra</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fc9edaec{}.cl-fc8f5162{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc8f516c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc953776{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc95378a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc956bce{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc956bd8{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc956be2{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc956be3{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc956bec{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc956bed{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fc9edaec"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fc956bce"><p class="cl-fc953776"><span class="cl-fc8f5162">species_code</span></p></th><th class="cl-fc956bd8"><p class="cl-fc95378a"><span class="cl-fc8f5162">scientific_name</span></p></th><th class="cl-fc956bd8"><p class="cl-fc95378a"><span class="cl-fc8f5162">common_name</span></p></th><th class="cl-fc956bd8"><p class="cl-fc95378a"><span class="cl-fc8f5162">id_rank</span></p></th><th class="cl-fc956bce"><p class="cl-fc953776"><span class="cl-fc8f5162">worms</span></p></th><th class="cl-fc956bce"><p class="cl-fc953776"><span class="cl-fc8f5162">itis</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fc956be2"><p class="cl-fc953776"><span class="cl-fc8f516c">10,130</span></p></td><td class="cl-fc956be3"><p class="cl-fc95378a"><span class="cl-fc8f516c">Hippoglossoides elassodon</span></p></td><td class="cl-fc956be3"><p class="cl-fc95378a"><span class="cl-fc8f516c">flathead sole</span></p></td><td class="cl-fc956be3"><p class="cl-fc95378a"><span class="cl-fc8f516c">species</span></p></td><td class="cl-fc956be2"><p class="cl-fc953776"><span class="cl-fc8f516c">274,289</span></p></td><td class="cl-fc956be2"><p class="cl-fc953776"><span class="cl-fc8f516c">172,875</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc956bec"><p class="cl-fc953776"><span class="cl-fc8f516c">20,731</span></p></td><td class="cl-fc956bed"><p class="cl-fc95378a"><span class="cl-fc8f516c">Rathbunella hypoplecta</span></p></td><td class="cl-fc956bed"><p class="cl-fc95378a"><span class="cl-fc8f516c">smooth ronquil</span></p></td><td class="cl-fc956bed"><p class="cl-fc95378a"><span class="cl-fc8f516c">species</span></p></td><td class="cl-fc956bec"><p class="cl-fc953776"><span class="cl-fc8f516c">282,556</span></p></td><td class="cl-fc956bec"><p class="cl-fc953776"><span class="cl-fc8f516c">170,954</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc956be2"><p class="cl-fc953776"><span class="cl-fc8f516c">21,308</span></p></td><td class="cl-fc956be3"><p class="cl-fc95378a"><span class="cl-fc8f516c">Thyriscus anoplus</span></p></td><td class="cl-fc956be3"><p class="cl-fc95378a"><span class="cl-fc8f516c">sponge sculpin</span></p></td><td class="cl-fc956be3"><p class="cl-fc95378a"><span class="cl-fc8f516c">species</span></p></td><td class="cl-fc956be2"><p class="cl-fc953776"><span class="cl-fc8f516c">282,971</span></p></td><td class="cl-fc956be2"><p class="cl-fc953776"><span class="cl-fc8f516c">167,367</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="ex.-visualize-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-in-cpue-data-in-distribution-map" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Ex. Visualize zero-filled data for 2023 eastern Bering Sea walleye pollock in CPUE data in distribution map</h1>
<p>Using the zero-filled data from the previous example, we can make a few plots!</p>
<p>Here is some example data of 2023 through 2019 (<code>year %in% 2019:2023</code>) eastern and northern Bering Sea (<code>srvy == c("EBS", "NBS)</code>) walleye pollock (<code>species_code == 21740</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dat0 <span class="ot">&lt;-</span> dat_zerofill_api <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2019</span><span class="sc">:</span><span class="dv">2023</span>) <span class="sc">&amp;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                  srvy <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"EBS"</span>, <span class="st">"NBS"</span>) <span class="sc">&amp;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                  species_code <span class="sc">==</span> <span class="dv">21740</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 1894; cols: 6"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat0, <span class="dv">3</span>) <span class="sc">%&gt;%</span> flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">%&gt;%</span> flextable<span class="sc">::</span><span class="fu">theme_zebra</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fdcbf5da{}.cl-fdb22024{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fdb22042{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fdb8af16{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fdb8af20{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fdb8e6fc{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdb8e710{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdb8e71a{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdb8e71b{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdb8e724{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdb8e72e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fdcbf5da"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">species_code</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">hauljoin</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">scientific_name</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">common_name</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">id_rank</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">worms</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">itis</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">year</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">srvy</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">survey</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">survey_name</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">survey_definition_id</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">cruise</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">cruisejoin</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">haul</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">stratum</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">station</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">vessel_id</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">vessel_name</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">date_time</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">latitude_dd_start</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">longitude_dd_start</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">latitude_dd_end</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">longitude_dd_end</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">bottom_temperature_c</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">surface_temperature_c</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">depth_m</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">distance_fished_km</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">duration_hr</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">net_width_m</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">net_height_m</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">area_swept_km2</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">performance</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">cpue_kgkm2</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">cpue_nokm2</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">count</span></p></th><th class="cl-fdb8e6fc"><p class="cl-fdb8af16"><span class="cl-fdb22024">weight_kg</span></p></th><th class="cl-fdb8e710"><p class="cl-fdb8af20"><span class="cl-fdb22024">taxon_confidence</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">21,740</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-21,852</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">Gadus chalcogrammus</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">walleye pollock</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">species</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">300,735</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">934,083</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">2,022</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">NBS</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">northern Bering Sea</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">Northern Bering Sea Crab/Groundfish Survey - Eastern Bering Sea Shelf Survey Extension</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">143</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">202,202</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-757</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">11</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">71</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">BB-10</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">94</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">VESTERAALEN</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">2022-08-04T07:08:54Z</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">64.01371</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-161.5309</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">63.98769</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-161.5255</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">9.7</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">13.0</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">17</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">2.904</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.526</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">15.472</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">2.562</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.044931</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">6.22</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.000000</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.00000</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.000</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">21,740</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">-21,854</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">Gadus chalcogrammus</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">walleye pollock</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">species</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">300,735</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">934,083</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">2,022</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">NBS</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">northern Bering Sea</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">Northern Bering Sea Crab/Groundfish Survey - Eastern Bering Sea Shelf Survey Extension</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">143</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">202,202</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">-757</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">13</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">71</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">BB-08</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">94</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">VESTERAALEN</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">2022-08-04T13:33:47Z</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">63.97936</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">-163.0456</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">64.00419</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">-163.0402</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">9.9</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">13.1</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">18</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">2.772</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.534</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">14.119</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">2.826</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.039138</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">4.10</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.868724</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">76.65211</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">3</span></p></td><td class="cl-fdb8e724"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.034</span></p></td><td class="cl-fdb8e72e"><p class="cl-fdb8af20"><span class="cl-fdb22042">High</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">21,740</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-21,868</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">Gadus chalcogrammus</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">walleye pollock</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">species</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">300,735</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">934,083</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">2,022</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">NBS</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">northern Bering Sea</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">Northern Bering Sea Crab/Groundfish Survey - Eastern Bering Sea Shelf Survey Extension</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">143</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">202,202</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-757</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">15</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">71</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">BB-05</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">94</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">VESTERAALEN</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">2022-08-05T11:52:49Z</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">64.03226</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-165.3191</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">64.00659</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">-165.3173</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">8.8</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">10.5</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">18</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">2.854</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.514</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">14.608</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">2.711</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.041691</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">0.00</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">127.892599</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">4,533.32730</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">189</span></p></td><td class="cl-fdb8e71a"><p class="cl-fdb8af16"><span class="cl-fdb22042">5.332</span></p></td><td class="cl-fdb8e71b"><p class="cl-fdb8af20"><span class="cl-fdb22042">High</span></p></td></tr></tbody></table></div>
</div>
</div>
<section id="plot-locations-on-map" class="level3" data-number="15.0.1">
<h3 data-number="15.0.1" class="anchored" data-anchor-id="plot-locations-on-map"><span class="header-section-number">15.0.1</span> Plot locations on map</h3>
<div class="cell" data-tbl-cap="CPUE (kg/km^2) of walleye pollock catch at each station in the 2019-2023 eastern and northern Bering Sea bottom trawl surveys. Size of black circles denote magnitude of CPUE caught at station and red triangles denote stations where walleye pollock were not caught. ">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> dat0 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(cpue_kgkm2 <span class="sc">!=</span> <span class="dv">0</span>), </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> longitude_dd_start, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> latitude_dd_start, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> cpue_kgkm2)) <span class="sc">+</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> dat0 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(cpue_kgkm2 <span class="sc">==</span> <span class="dv">0</span>), </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha =</span> .<span class="dv">75</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Longitude *W"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Latitude *N"</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"CPUE (kg/km^2) of walleye pollock (Weight CPUE; kg/km2)"</span>, </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">subtitle =</span> <span class="st">"Eastern Bering Sea bottom trawl survey"</span>) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (kg)"</span>) <span class="sc">+</span> </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(year)) <span class="sc">+</span> </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="foss-api-r_files/figure-html/pollock-multi-loc-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-inverse-distance-weighted-plot-of-cpue" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="plot-inverse-distance-weighted-plot-of-cpue"><span class="header-section-number">15.1</span> Plot inverse-distance weighted plot of CPUE</h2>
<p>This map is constructed using <a href="https://github.com/afsc-gap-products/akgfmaps"><code>akgfmaps</code></a>. To make IDW plots, you must have data from all stations surveyed, even if no fish of interest were found there.</p>
<p>These plots are similar to those published in the <a href="https://www.fisheries.noaa.gov/alaska/science-data/groundfish-assessment-program-bottom-trawl-surveys#communications">annual Bering Sea data reports</a>.</p>
<div class="cell" data-tbl-cap="Inverse-distance weight CPUE of walleye pollock catch at each station in the 2019-2023 eastern and northern Bering Sea bottom trawl surveys. ">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("afsc-gap-products/akgfmaps", build_vignettes = TRUE)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(akgfmaps)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>idw <span class="ot">&lt;-</span> akgfmaps<span class="sc">::</span><span class="fu">make_idw_stack</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dat0 <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">COMMON_NAME =</span> common_name, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">CPUE_KGHA =</span> cpue_kgkm2, </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">LATITUDE =</span> latitude_dd_start, </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">LONGITUDE =</span> longitude_dd_start, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                  year), </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">grouping.vars =</span> <span class="st">"year"</span>, </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"bs.all"</span>, <span class="co"># Predefined EBS area</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">set.breaks =</span> <span class="st">"jenks"</span>, <span class="co"># Gets Jenks breaks from classint::classIntervals()</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">in.crs =</span> <span class="st">"+proj=longlat"</span>, <span class="co"># Set input coordinate reference system</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">out.crs =</span> <span class="st">"EPSG:3338"</span>, <span class="co"># Set output coordinate reference system</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">extrapolation.grid.type =</span> <span class="st">"sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[inverse distance weighted interpolation]
[inverse distance weighted interpolation]
[inverse distance weighted interpolation]
[inverse distance weighted interpolation]
[inverse distance weighted interpolation]
[inverse distance weighted interpolation]
[inverse distance weighted interpolation]
[inverse distance weighted interpolation]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>shps <span class="ot">&lt;-</span> akgfmaps<span class="sc">::</span><span class="fu">get_base_layers</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">select.region =</span> <span class="st">"bs.all"</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.corners =</span> <span class="cn">TRUE</span>, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">set.crs =</span> <span class="st">"EPSG:3338"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set.breaks &lt;- akgfmaps::eval_plot_breaks(CPUE = dat0$cpue_kgkm2, n.breaks = 5)</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set.breaks &lt;- as.vector(unlist(set.breaks[set.breaks$style == "pretty", -1]))</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>set.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">100000</span>, <span class="dv">150000</span>, <span class="dv">200000</span>, <span class="dv">250000</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>figure_print <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add map of alaska</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(<span class="at">data =</span> shps<span class="sc">$</span>akland,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add IDW plots</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> idw<span class="sc">$</span>extrapolation.stack,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> var1.pred),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"walleye pollock</span><span class="sc">\n</span><span class="st">CPUE (kg/km2)"</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span>  <span class="fu">c</span>(<span class="st">"gray90"</span>,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                viridis<span class="sc">::</span><span class="fu">viridis</span>(</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">option =</span> <span class="st">"mako"</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n =</span> <span class="fu">length</span>(set.breaks)<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">begin =</span> <span class="fl">0.20</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">end =</span> <span class="fl">0.80</span>)),</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.translate =</span> <span class="cn">FALSE</span>, <span class="co"># Don't use NA</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># seperate plots by year</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(year), <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add survey area</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> shps<span class="sc">$</span>survey.area, </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> SURVEY, </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">geometry =</span> geometry), </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">" "</span>, </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey30"</span>, <span class="st">"grey50"</span>),</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> shps<span class="sc">$</span>survey.area<span class="sc">$</span>SURVEY,</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> shps<span class="sc">$</span>survey.area<span class="sc">$</span>SRVY) <span class="sc">+</span> </span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lat/lon axis and map bounds</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Longitude °W"</span>,</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">180</span>, <span class="sc">-</span><span class="dv">150</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Latitude °N"</span>,</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">50</span>, <span class="dv">65</span>, <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># seq(52, 62, 2)</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_sf</span>(<span class="at">xlim =</span> sf<span class="sc">::</span><span class="fu">st_bbox</span>(shps<span class="sc">$</span>survey.area)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)],</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ylim =</span> sf<span class="sc">::</span><span class="fu">st_bbox</span>(shps<span class="sc">$</span>survey.area)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]) <span class="sc">+</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add theme aesthetics</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">guides</span>(</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">order =</span> <span class="dv">1</span>,</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">label.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>( </span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>), </span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>), </span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"transparent"</span>, </span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"transparent"</span>, </span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>), <span class="co"># reduce space between legend &amp; plot</span></span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>) )</span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>figure_print</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="foss-api-r_files/figure-html/pollock-multi-idw-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ex.-show-catch-data-for-2023-eastern-bering-sea-walleye-pollock-one-species-in-one-survey-region-in-one-year" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Ex. Show catch data for 2023 eastern Bering Sea Walleye Pollock (one species in one survey region in one year)</h1>
<p>Data downloads and joins for just one species, survey, and year are much faster and easier to do.</p>
<p>First, because <code>year</code> is identified in the haul table, we need to identify all of the hauls (or more specifically, <code>hauljoin</code> codes) that were completed in the eastern Bering Sea (<code>"srvy":"EBS"</code>) in 2023 (<code>"year":2023</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## query the API link</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_haul, <span class="st">'?limit=10000&amp;q={"year":2023,"srvy":"EBS"}'</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="do">## convert from JSON format</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content)) </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data<span class="sc">$</span>items <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links) <span class="co"># necessary for API accounting, but not part of the dataset</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="do">## show summary of data to make sure it is subset correctly</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">srvy =</span> <span class="fu">as.factor</span>(srvy)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year       srvy        survey          survey_name       
 Min.   :2023   EBS:376   Length:376         Length:376        
 1st Qu.:2023             Class :character   Class :character  
 Median :2023             Mode  :character   Mode  :character  
 Mean   :2023                                                  
 3rd Qu.:2023                                                  
 Max.   :2023                                                  
 survey_definition_id     cruise         cruisejoin        hauljoin     
 Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  
 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  
 Median :98           Median :202301   Median :-759.0   Median :-22539  
 Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  
 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  
 Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  
      haul           stratum        station            vessel_id    
 Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  
 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  
 Median :114.00   Median :41.00   Mode  :character   Median :162.0  
 Mean   :114.16   Mean   :39.22                      Mean   :148.3  
 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  
 Max.   :224.00   Max.   :90.00                      Max.   :162.0  
 vessel_name         date_time         latitude_dd_start longitude_dd_start
 Length:376         Length:376         Min.   :54.66     Min.   :-178.2    
 Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    
 Mode  :character   Mode  :character   Median :58.02     Median :-168.9    
                                       Mean   :58.26     Mean   :-168.8    
                                       3rd Qu.:59.50     3rd Qu.:-165.2    
                                       Max.   :62.01     Max.   :-158.3    
 latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c
 Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       
 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       
 Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       
 Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       
 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       
 Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       
    depth_m       distance_fished_km  duration_hr      net_width_m   
 Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  
 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  
 Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  
 Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  
 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  
 Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  
  net_height_m   area_swept_km2     performance    
 Min.   :1.300   Min.   :0.02017   Min.   :0.0000  
 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000  
 Median :2.064   Median :0.04944   Median :0.0000  
 Mean   :2.107   Mean   :0.04892   Mean   :0.1075  
 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000  
 Max.   :3.196   Max.   :0.06369   Max.   :6.2200  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Find how many rows and columns are in the data pull. </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The eastern Bering Sea survey has 376 stations in it, </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="do">## so this should have a similar number of rows. </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 376; cols: 27"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save outputs for later comparison</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>dat_haul_ex <span class="ot">&lt;-</span> dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few lines of the data </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat_haul_ex, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-2db26c52{}.cl-2da11d58{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2da11d6c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2da79822{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2da79836{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2da7cfe0{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2da7cfea{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2da7cff4{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2da7cffe{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2da7cfff{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2da7d008{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-2db26c52"><caption><p>Haul data filtered by <code>year = 2023</code> and
<code>SRVY = 'EBS'</code>.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">year</span></p></th><th class="cl-2da7cfea"><p class="cl-2da79836"><span class="cl-2da11d58">srvy</span></p></th><th class="cl-2da7cfea"><p class="cl-2da79836"><span class="cl-2da11d58">survey</span></p></th><th class="cl-2da7cfea"><p class="cl-2da79836"><span class="cl-2da11d58">survey_name</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">survey_definition_id</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">cruise</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">cruisejoin</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">hauljoin</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">haul</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">stratum</span></p></th><th class="cl-2da7cfea"><p class="cl-2da79836"><span class="cl-2da11d58">station</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">vessel_id</span></p></th><th class="cl-2da7cfea"><p class="cl-2da79836"><span class="cl-2da11d58">vessel_name</span></p></th><th class="cl-2da7cfea"><p class="cl-2da79836"><span class="cl-2da11d58">date_time</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">latitude_dd_start</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">longitude_dd_start</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">latitude_dd_end</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">longitude_dd_end</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">bottom_temperature_c</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">surface_temperature_c</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">depth_m</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">distance_fished_km</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">duration_hr</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">net_width_m</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">net_height_m</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">area_swept_km2</span></p></th><th class="cl-2da7cfe0"><p class="cl-2da79822"><span class="cl-2da11d58">performance</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">2023</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">EBS</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">eastern Bering Sea</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">98</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">202301</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-759</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-22,123</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">25</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">10</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">E-12</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">162</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">ALASKA KNIGHT</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">2023-05-28T15:56:41Z</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">56.33791</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-160.9950</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">56.33839</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-161.0420</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">4.0</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">4.2</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">54</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">2.917</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">0.522</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">16.079</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">1.983</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">0.046902</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">2023</span></p></td><td class="cl-2da7d008"><p class="cl-2da79836"><span class="cl-2da11d6c">EBS</span></p></td><td class="cl-2da7d008"><p class="cl-2da79836"><span class="cl-2da11d6c">eastern Bering Sea</span></p></td><td class="cl-2da7d008"><p class="cl-2da79836"><span class="cl-2da11d6c">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">98</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">202301</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">-759</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">-22,125</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">27</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">31</span></p></td><td class="cl-2da7d008"><p class="cl-2da79836"><span class="cl-2da11d6c">F-13</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">162</span></p></td><td class="cl-2da7d008"><p class="cl-2da79836"><span class="cl-2da11d6c">ALASKA KNIGHT</span></p></td><td class="cl-2da7d008"><p class="cl-2da79836"><span class="cl-2da11d6c">2023-05-29T10:48:20Z</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">56.65813</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">-160.3893</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">56.67233</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">-160.3497</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">3.7</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">3.7</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">59</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">2.900</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">0.525</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">17.206</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">1.932</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">0.049897</span></p></td><td class="cl-2da7cfff"><p class="cl-2da79822"><span class="cl-2da11d6c">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">2023</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">EBS</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">eastern Bering Sea</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">98</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">202301</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-759</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-22,126</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">28</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">10</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">F-14</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">162</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">ALASKA KNIGHT</span></p></td><td class="cl-2da7cffe"><p class="cl-2da79836"><span class="cl-2da11d6c">2023-05-29T14:17:28Z</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">56.67258</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-159.7784</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">56.68401</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">-159.7380</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">4.6</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">4.7</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">37</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">2.790</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">0.511</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">15.529</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">2.355</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">0.043326</span></p></td><td class="cl-2da7cff4"><p class="cl-2da79822"><span class="cl-2da11d6c">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<section id="identify-species_code-for-walleye-pollock" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="identify-species_code-for-walleye-pollock"><span class="header-section-number">16.1</span> Identify <code>species_code</code> for walleye pollock</h2>
<p>In the catch data, we itemize species catches by <code>species_code</code>. To find out which <code>species_code</code> to use, you can check variations on the following code. Note that here the word <code>pollock</code> is case sensitive. All species <code>common_name</code> entries are lower case except for proper nouns (e.g., “Pacific”). The notation for finding a string is to use <code>%</code> around the phrase. Since <code>%</code> is a reserved character in a URL, you have to replace <code>%</code> with <code>%25</code>. Similarly, <code>%20</code> needs to be used in place of a space (e.g., between “walleye” and “pollock”: <code>"walleye%20pollock"}'</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## query the API link. Use: </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_species, <span class="st">'?q={%22common_name%22:%22walleye%20pollock%22}'</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_species, <span class="st">'?q={"common_name":{"$like":"%25pollock%25"}}'</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_species, <span class="st">'?q={"common_name":"walleye%20pollock"}'</span>))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="do">## convert from JSON format</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content)) </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save outputs for later comparison</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>dat_species_ex <span class="ot">&lt;-</span> data<span class="sc">$</span>items <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links) <span class="co"># necessary for API accounting, but not part of the dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dat_species_ex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-2e678204{}.cl-2e569e44{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2e569e62{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2e5d4424{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2e5d4438{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2e5d7ad4{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2e5d7ae8{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2e5d7af2{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2e5d7afc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-2e678204"><caption><p>Walleye pollock species information.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-2e5d7ad4"><p class="cl-2e5d4424"><span class="cl-2e569e44">species_code</span></p></th><th class="cl-2e5d7ae8"><p class="cl-2e5d4438"><span class="cl-2e569e44">scientific_name</span></p></th><th class="cl-2e5d7ae8"><p class="cl-2e5d4438"><span class="cl-2e569e44">common_name</span></p></th><th class="cl-2e5d7ae8"><p class="cl-2e5d4438"><span class="cl-2e569e44">id_rank</span></p></th><th class="cl-2e5d7ad4"><p class="cl-2e5d4424"><span class="cl-2e569e44">worms</span></p></th><th class="cl-2e5d7ad4"><p class="cl-2e5d4424"><span class="cl-2e569e44">itis</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2e5d7af2"><p class="cl-2e5d4424"><span class="cl-2e569e62">21740</span></p></td><td class="cl-2e5d7afc"><p class="cl-2e5d4438"><span class="cl-2e569e62">Gadus chalcogrammus</span></p></td><td class="cl-2e5d7afc"><p class="cl-2e5d4438"><span class="cl-2e569e62">walleye pollock</span></p></td><td class="cl-2e5d7afc"><p class="cl-2e5d4438"><span class="cl-2e569e62">species</span></p></td><td class="cl-2e5d7af2"><p class="cl-2e5d4424"><span class="cl-2e569e62">300735</span></p></td><td class="cl-2e5d7af2"><p class="cl-2e5d4424"><span class="cl-2e569e62">934083</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="then-apply-the-hauljoins-and-species_code-to-catch-query" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="then-apply-the-hauljoins-and-species_code-to-catch-query"><span class="header-section-number">16.2</span> Then, apply the <code>hauljoins</code> and <code>species_code</code> to catch query</h2>
<p>We’ll use the data from the haul and species table we collected before to select 2023 eastern Bering Sea walleye pollock catch data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## query the API link</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data for all walleye pollock caught in all 2023 eastern Bering Sea survey hauls</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># there must be a better way to select multiple values for one parameter, </span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># but saving that, we will loop through each hauljoin and collect the data of interest</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat_haul_ex)) {</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    api_link_catch, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'?q={"species_code":21740,"hauljoin":'</span>, dat_haul_ex<span class="sc">$</span>hauljoin[i],<span class="st">'}'</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## convert from JSON format</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content)) </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(data<span class="sc">$</span>items) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>      dat,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>items <span class="sc">%&gt;%</span> </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links)) <span class="co"># necessary for API accounting, but not part of the dataset</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="do">## show summary of data to make sure it is subset correctly</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    hauljoin       species_code     cpue_kgkm2          cpue_nokm2       
 Min.   :-23019   Min.   :21740   Min.   :    10.34   Min.   :    18.26  
 1st Qu.:-22777   1st Qu.:21740   1st Qu.:  1454.44   1st Qu.:  2278.72  
 Median :-22540   Median :21740   Median :  3286.76   Median :  5875.33  
 Mean   :-22553   Mean   :21740   Mean   :  6364.85   Mean   : 11565.45  
 3rd Qu.:-22324   3rd Qu.:21740   3rd Qu.:  6956.25   3rd Qu.: 12512.98  
 Max.   :-22110   Max.   :21740   Max.   :148679.68   Max.   :202321.08  
                                                      NA's   :1          
     count        weight_kg        taxon_confidence  
 Min.   :   1   Min.   :   0.492   Length:374        
 1st Qu.: 114   1st Qu.:  71.560   Class :character  
 Median : 286   Median : 162.310   Mode  :character  
 Mean   : 574   Mean   : 315.419                     
 3rd Qu.: 619   3rd Qu.: 350.399                     
 Max.   :9997   Max.   :7346.495                     
 NA's   :1                                           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Find how many rows and columns are in the data pull. </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The eastern Bering Sea survey has 376 stations in it, </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="do">## and pollock are often found in throughout the region</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="do">## so this should have a similar number of rows. </span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 374; cols: 7"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save outputs for later comparison</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>dat_catch_ex <span class="ot">&lt;-</span> dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few lines of the data </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-5a04b210{}.cl-59f1db68{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-59f1db7c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-59f8de68{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-59f8de72{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-59f91d1a{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-59f91d2e{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-59f91d38{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-59f91d39{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-59f91d42{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-59f91d43{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-5a04b210"><caption><p>Catch data for all 2023 eastern Bering Sea Walleye Pollock.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-59f91d1a"><p class="cl-59f8de68"><span class="cl-59f1db68">hauljoin</span></p></th><th class="cl-59f91d1a"><p class="cl-59f8de68"><span class="cl-59f1db68">species_code</span></p></th><th class="cl-59f91d1a"><p class="cl-59f8de68"><span class="cl-59f1db68">cpue_kgkm2</span></p></th><th class="cl-59f91d1a"><p class="cl-59f8de68"><span class="cl-59f1db68">cpue_nokm2</span></p></th><th class="cl-59f91d1a"><p class="cl-59f8de68"><span class="cl-59f1db68">count</span></p></th><th class="cl-59f91d1a"><p class="cl-59f8de68"><span class="cl-59f1db68">weight_kg</span></p></th><th class="cl-59f91d2e"><p class="cl-59f8de72"><span class="cl-59f1db68">taxon_confidence</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">-22,123</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">21740</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">3,969.8145</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">4,413.416</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">207</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">186.194</span></p></td><td class="cl-59f91d39"><p class="cl-59f8de72"><span class="cl-59f1db7c">High</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-59f91d42"><p class="cl-59f8de68"><span class="cl-59f1db7c">-22,125</span></p></td><td class="cl-59f91d42"><p class="cl-59f8de68"><span class="cl-59f1db7c">21740</span></p></td><td class="cl-59f91d42"><p class="cl-59f8de68"><span class="cl-59f1db7c">3,872.0254</span></p></td><td class="cl-59f91d42"><p class="cl-59f8de68"><span class="cl-59f1db7c">8,477.396</span></p></td><td class="cl-59f91d42"><p class="cl-59f8de68"><span class="cl-59f1db7c">423</span></p></td><td class="cl-59f91d42"><p class="cl-59f8de68"><span class="cl-59f1db7c">193.204</span></p></td><td class="cl-59f91d43"><p class="cl-59f8de72"><span class="cl-59f1db7c">High</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">-22,126</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">21740</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">172.2526</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">553.941</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">24</span></p></td><td class="cl-59f91d38"><p class="cl-59f8de68"><span class="cl-59f1db7c">7.463</span></p></td><td class="cl-59f91d39"><p class="cl-59f8de72"><span class="cl-59f1db7c">High</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>For reference and to help break down the above query, see these other query examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data for haul -22775 (i.e., one specific haul)?</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_catch, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'?offset='</span>,i,<span class="st">'&amp;limit=10000&amp;q={"hauljoin":-22775}'</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data for all walleye pollock (i.e., one species) caught in all years and surveys</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(api_link_catch, </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'?offset='</span>,i,<span class="st">'&amp;limit=10000&amp;q={"species_code":21740}'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-and-plot" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="create-zero-filled-data-for-2023-eastern-bering-sea-walleye-pollock-and-plot"><span class="header-section-number">16.3</span> Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot</h2>
<p>It is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  dat_haul_ex,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  dat_catch_ex) <span class="sc">%&gt;%</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    dat_species_ex)  <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># modify zero-filled rows</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cpue_kgkm2 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(cpue_kgkm2), <span class="dv">0</span>, cpue_kgkm2),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cpue_nokm2 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(cpue_nokm2), <span class="dv">0</span>, cpue_nokm2),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(count), <span class="dv">0</span>, count),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_kg =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(weight_kg), <span class="dv">0</span>, weight_kg))</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="do">## show summary of data to make sure it is subset correctly</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year          srvy              survey          survey_name       
 Min.   :2023   Length:376         Length:376         Length:376        
 1st Qu.:2023   Class :character   Class :character   Class :character  
 Median :2023   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2023                                                           
 3rd Qu.:2023                                                           
 Max.   :2023                                                           
                                                                        
 survey_definition_id     cruise         cruisejoin        hauljoin     
 Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  
 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  
 Median :98           Median :202301   Median :-759.0   Median :-22539  
 Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  
 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  
 Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  
                                                                        
      haul           stratum        station            vessel_id    
 Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  
 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  
 Median :114.00   Median :41.00   Mode  :character   Median :162.0  
 Mean   :114.16   Mean   :39.22                      Mean   :148.3  
 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  
 Max.   :224.00   Max.   :90.00                      Max.   :162.0  
                                                                    
 vessel_name         date_time         latitude_dd_start longitude_dd_start
 Length:376         Length:376         Min.   :54.66     Min.   :-178.2    
 Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    
 Mode  :character   Mode  :character   Median :58.02     Median :-168.9    
                                       Mean   :58.26     Mean   :-168.8    
                                       3rd Qu.:59.50     3rd Qu.:-165.2    
                                       Max.   :62.01     Max.   :-158.3    
                                                                           
 latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c
 Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       
 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       
 Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       
 Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       
 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       
 Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       
                                                                            
    depth_m       distance_fished_km  duration_hr      net_width_m   
 Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  
 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  
 Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  
 Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  
 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  
 Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  
                                                                     
  net_height_m   area_swept_km2     performance      species_code  
 Min.   :1.300   Min.   :0.02017   Min.   :0.0000   Min.   :21740  
 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000   1st Qu.:21740  
 Median :2.064   Median :0.04944   Median :0.0000   Median :21740  
 Mean   :2.107   Mean   :0.04892   Mean   :0.1075   Mean   :21740  
 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000   3rd Qu.:21740  
 Max.   :3.196   Max.   :0.06369   Max.   :6.2200   Max.   :21740  
                                                    NA's   :2      
   cpue_kgkm2       cpue_nokm2         count          weight_kg      
 Min.   :     0   Min.   :     0   Min.   :   0.0   Min.   :   0.00  
 1st Qu.:  1431   1st Qu.:  2238   1st Qu.: 111.5   1st Qu.:  70.64  
 Median :  3273   Median :  5842   Median : 280.0   Median : 161.44  
 Mean   :  6331   Mean   : 11473   Mean   : 569.4   Mean   : 313.74  
 3rd Qu.:  6946   3rd Qu.: 12345   3rd Qu.: 611.5   3rd Qu.: 349.81  
 Max.   :148680   Max.   :202321   Max.   :9997.0   Max.   :7346.49  
                                                                     
 taxon_confidence   scientific_name    common_name          id_rank         
 Length:376         Length:376         Length:376         Length:376        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     worms             itis       
 Min.   :300735   Min.   :934083  
 1st Qu.:300735   1st Qu.:934083  
 Median :300735   Median :934083  
 Mean   :300735   Mean   :934083  
 3rd Qu.:300735   3rd Qu.:934083  
 Max.   :300735   Max.   :934083  
 NA's   :2        NA's   :2       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Find how many rows and columns are in the data pull. </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Because all of the data have been full joined together, </span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="do">## there should be the maximum number of rows. </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"rows: "</span>, <span class="fu">nrow</span>(dat), <span class="st">"; cols: "</span>, <span class="fu">ncol</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rows: 376; cols: 38"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-5a86aa90{}.cl-5a73d4ba{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5a7a76bc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5a7a76d0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5a7ab24e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a7ab258{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a7ab262{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a7ab263{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a7ab26c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a7ab276{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-5a86aa90"><thead><tr style="overflow-wrap:break-word;"><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">year</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">srvy</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">survey</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">survey_name</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">survey_definition_id</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">cruise</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">cruisejoin</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">hauljoin</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">haul</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">stratum</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">station</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">vessel_id</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">vessel_name</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">date_time</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">latitude_dd_start</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">longitude_dd_start</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">latitude_dd_end</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">longitude_dd_end</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">bottom_temperature_c</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">surface_temperature_c</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">depth_m</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">distance_fished_km</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">duration_hr</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">net_width_m</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">net_height_m</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">area_swept_km2</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">performance</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">species_code</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">cpue_kgkm2</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">cpue_nokm2</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">count</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">weight_kg</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">taxon_confidence</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">scientific_name</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">common_name</span></p></th><th class="cl-5a7ab258"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">id_rank</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">worms</span></p></th><th class="cl-5a7ab24e"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">itis</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2,023</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">EBS</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">eastern Bering Sea</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">98</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">202,301</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-759</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-22,123</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">25</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">10</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">E-12</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">162</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">ALASKA KNIGHT</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">2023-05-28T15:56:41Z</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">56.33791</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-160.9950</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">56.33839</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-161.0420</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">4.0</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">4.2</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">54</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2.917</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0.522</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">16.079</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">1.983</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0.046902</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">21,740</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">3,969.8145</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">4,413.416</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">207</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">186.194</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">High</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">Gadus chalcogrammus</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">walleye pollock</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">species</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">300,735</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">934,083</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2,023</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">EBS</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">eastern Bering Sea</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">98</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">202,301</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-759</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-22,125</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">27</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">31</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">F-13</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">162</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">ALASKA KNIGHT</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">2023-05-29T10:48:20Z</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">56.65813</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-160.3893</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">56.67233</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-160.3497</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">3.7</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">3.7</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">59</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2.900</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0.525</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">17.206</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">1.932</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0.049897</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">21,740</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">3,872.0254</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">8,477.396</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">423</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">193.204</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">High</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">Gadus chalcogrammus</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">walleye pollock</span></p></td><td class="cl-5a7ab263"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">species</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">300,735</span></p></td><td class="cl-5a7ab262"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">934,083</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2,023</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">EBS</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">eastern Bering Sea</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">98</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">202,301</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-759</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-22,126</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">28</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">10</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">F-14</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">162</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">ALASKA KNIGHT</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">2023-05-29T14:17:28Z</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">56.67258</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-159.7784</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">56.68401</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">-159.7380</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">4.6</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">4.7</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">37</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2.790</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0.511</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">15.529</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">2.355</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0.043326</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">0</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">21,740</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">172.2526</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">553.941</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">24</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">7.463</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">High</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">Gadus chalcogrammus</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">walleye pollock</span></p></td><td class="cl-5a7ab276"><p class="cl-5a7a76d0"><span class="cl-5a73d4ba">species</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">300,735</span></p></td><td class="cl-5a7ab26c"><p class="cl-5a7a76bc"><span class="cl-5a73d4ba">934,083</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="visualize-cpue-data-in-distribution-map" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="visualize-cpue-data-in-distribution-map"><span class="header-section-number">16.4</span> Visualize CPUE data in distribution map</h2>
<p>Using the zero-filled data from the previous example, we can make a few plots!</p>
</section>
<section id="plot-locations" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="plot-locations"><span class="header-section-number">16.5</span> Plot locations</h2>
<div class="cell" data-tbl-cap="CPUE (kg/km^2) of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Size of black circles denote magnitude of CPUE caught at station and red triangles denote stations where walleye pollock were not caught. ">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> dat <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(cpue_kgkm2 <span class="sc">!=</span> <span class="dv">0</span>), </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> longitude_dd_start, </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> latitude_dd_start, </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> cpue_kgkm2)) <span class="sc">+</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> dat <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(cpue_kgkm2 <span class="sc">==</span> <span class="dv">0</span>), </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha =</span> .<span class="dv">75</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Longitude *W"</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Latitude *N"</span>) <span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Catches of walleye pollock (Weight CPUE; kg/km2)"</span>, </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">subtitle =</span> <span class="st">"2023 eastern Bering Sea bottom trawl survey"</span>) <span class="sc">+</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (kg)"</span>) <span class="sc">+</span> </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="foss-api-r_files/figure-html/pollock-multi1-loc-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-inverse-distance-weighted-modeled-product-of-locations" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="plot-inverse-distance-weighted-modeled-product-of-locations"><span class="header-section-number">16.6</span> Plot inverse-distance weighted modeled product of locations</h2>
<p>This map is constructed using <a href="https://github.com/afsc-gap-products/akgfmaps"><code>akgfmaps</code></a></p>
<div class="cell" data-tbl-cap="Inverse-distance weight CPUE of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. ">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("afsc-gap-products/akgfmaps", build_vignettes = TRUE)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(akgfmaps)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>figure0 <span class="ot">&lt;-</span> akgfmaps<span class="sc">::</span><span class="fu">make_idw_map</span>(</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CPUE_KGHA =</span> dat<span class="sc">$</span>cpue_kgkm2, <span class="co"># calculates the same, regardless of units.  </span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">LATITUDE =</span> dat<span class="sc">$</span>latitude_dd_start, </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">LONGITUDE =</span> dat<span class="sc">$</span>longitude_dd_start, </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"bs.south"</span>, <span class="co"># Predefined EBS area</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">set.breaks =</span> <span class="st">"jenks"</span>, <span class="co"># Gets Jenks breaks from classint::classIntervals()</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">in.crs =</span> <span class="st">"+proj=longlat"</span>, <span class="co"># Set input coordinate reference system</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">out.crs =</span> <span class="st">"EPSG:3338"</span>, <span class="co"># Set output coordinate reference system</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">extrapolation.grid.type =</span> <span class="st">"sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[inverse distance weighted interpolation]
[inverse distance weighted interpolation]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>figure0<span class="sc">$</span>plot <span class="sc">+</span> <span class="co"># 20x20km grid</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"walleye pollock</span><span class="sc">\n</span><span class="st">CPUE (kg/km2)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="foss-api-r_files/figure-html/pollock-multi2-loc-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="other-query-examples" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Other query examples</h1>
<section id="ex.-combination-of-year-srvy-stratum" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="ex.-combination-of-year-srvy-stratum"><span class="header-section-number">17.1</span> Ex. Combination of year, srvy, stratum</h2>
<p>Show haul data where year is less than 1989, srvy = “EBS”, and stratum is not equal to 81.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(api_link_haul, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">'?&amp;limit=10000&amp;q={"year":{"$lt":1989},"stratum":{"$ne":"81"},"srvy":"EBS"}}'</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(base<span class="sc">::</span><span class="fu">rawToChar</span>(res<span class="sc">$</span>content))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data<span class="sc">$</span>items <span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>links) <span class="co"># necessary for API accounting, but not part of the dataset)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/afsc-gap-products\.github\.io\/gap_products");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../content/foss-platform.html" class="pagination-link" aria-label="Using the FOSS platform">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Using the FOSS platform</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../content/foss-api-py.html" class="pagination-link" aria-label="Access via API and Python">
        <span class="nav-page-text"><span class="chapter-title">Access via API and Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© CC-1.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/afsc-gap-products/gap_products/edit/main/content/foss-api-r.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/afsc-gap-products/gap_products/blob/main/content/foss-api-r.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/afsc-gap-products/gap_products/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a href="https://www.commerce.gov/">U.S. Department of Commerce</a> | <a href="https://www.noaa.gov">National Oceanographic and Atmospheric Administration</a> | <a href="https://www.fisheries.noaa.gov/">NOAA Fisheries</a></p>
</div>
  </div>
</footer>




</body></html>