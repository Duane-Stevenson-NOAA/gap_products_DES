{
  "hash": "17da681d2c7dccd90fab91635e1ceda7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Access via API and R\nnumber-sections: true\n---\n\n\n\n\n\n\n**An application programming interface (API) is a way for two or more computer programs to communicate with each other.** More information about how to amend API links can be found [here](https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/22.3/books.html#AELIG90103/). Useful introductions to using APIs in `R` can be found [here](https://www.dataquest.io/blog/r-api-tutorial/). \n\nThere are three tables the user can pull from the API. Learn more about them on the [FOSS data description page](https://afsc-gap-products.github.io/gap_products/content/foss-metadata.html). Here, you can see them in their raw JSON format:\n -  haul: (https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/)[https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/]\n - catch: (https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/)[https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/]\n - species: (https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/)[https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/]\n\nHere are some examples of how to use the data with R:\n\n# Examples of all species in all survey regions in all years\n\n## Ex. Load all rows of the catch, haul, and species data tables\n\nNote that without specifying, a basic query to the API will only return 25 entries. \n\n### Haul data: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_haul <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/'\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n**Load first 25 rows of data:** \n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = api_link_haul)\n# res ## Test connection\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(data$items)[1], \"; cols: \", dim(data$items)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 25; cols: 28\"\n```\n\n\n:::\n:::\n\n\n**Load all data:**\n\nSince the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by `offsetting` to the next 10,000 rows (as is shown here). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame()\nfor (i in seq(0, 500000, 10000)){\n  ## find how many iterations it takes to cycle through the data\n  print(i)\n  ## query the API link\n  res <- httr::GET(url = paste0(api_link_haul, \"?offset=\",i,\"&limit=10000\"))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  \n  ## if there are no data, stop the loop\n  if (is.null(nrow(data$items))) {\n    break\n  }\n  \n  ## bind sub-pull to dat data.frame\n  dat <- dplyr::bind_rows(dat, \n                          data$items %>%\n                            dplyr::select(-links)) # necessary for API accounting, but not part of the dataset)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n[1] 10000\n[1] 20000\n[1] 30000\n[1] 40000\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year          srvy              survey          survey_name       \n Min.   :1982   Length:33334       Length:33334       Length:33334      \n 1st Qu.:1996   Class :character   Class :character   Class :character  \n Median :2005   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2005                                                           \n 3rd Qu.:2014                                                           \n Max.   :2023                                                           \n                                                                        \n survey_definition_id     cruise         cruisejoin         hauljoin      \n Min.   : 47.00       Min.   :198201   Min.   :   -766   Min.   : -23126  \n 1st Qu.: 47.00       1st Qu.:199601   1st Qu.:   -691   1st Qu.: -13535  \n Median : 78.00       Median :200501   Median :   -612   Median :  -3958  \n Mean   : 74.51       Mean   :200507   Mean   : 300438   Mean   : 295896  \n 3rd Qu.: 98.00       3rd Qu.:201401   3rd Qu.: 837800   3rd Qu.: 821743  \n Max.   :143.00       Max.   :202302   Max.   :1225395   Max.   :1225635  \n                                                                          \n      haul          stratum        station            vessel_id    \n Min.   :  1.0   Min.   : 10.0   Length:33334       Min.   :  1.0  \n 1st Qu.: 56.0   1st Qu.: 31.0   Class :character   1st Qu.: 88.0  \n Median :112.0   Median : 50.0   Mode  :character   Median : 94.0  \n Mean   :117.6   Mean   :129.1                      Mean   :106.9  \n 3rd Qu.:170.0   3rd Qu.:141.0                      3rd Qu.:147.0  \n Max.   :355.0   Max.   :794.0                      Max.   :178.0  \n                                                                   \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:33334       Length:33334       Min.   :51.19     Min.   :-180.0    \n Class :character   Class :character   1st Qu.:55.02     1st Qu.:-170.7    \n Mode  :character   Mode  :character   Median :57.18     Median :-165.2    \n                                       Mean   :56.89     Mean   :-140.4    \n                                       3rd Qu.:58.98     3rd Qu.:-154.4    \n                                       Max.   :65.34     Max.   : 180.0    \n                                                                           \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :51.19   Min.   :-180.0   Min.   :-2.10        Min.   :-1.100       \n 1st Qu.:55.02   1st Qu.:-170.7   1st Qu.: 2.70        1st Qu.: 5.800       \n Median :57.18   Median :-165.2   Median : 4.10        Median : 7.500       \n Mean   :56.89   Mean   :-140.4   Mean   : 3.84        Mean   : 7.832       \n 3rd Qu.:58.97   3rd Qu.:-154.4   3rd Qu.: 5.20        3rd Qu.: 9.400       \n Max.   :65.35   Max.   : 180.0   Max.   :15.30        Max.   :18.100       \n NA's   :4       NA's   :4        NA's   :1601         NA's   :849          \n    depth_m     distance_fished_km  duration_hr      net_width_m   \n Min.   :   9   Min.   :0.135      Min.   :0.0250   Min.   : 7.51  \n 1st Qu.:  68   1st Qu.:1.498      1st Qu.:0.2710   1st Qu.:15.59  \n Median : 102   Median :2.527      Median :0.4900   Median :16.40  \n Mean   : 138   Mean   :2.207      Mean   :0.4007   Mean   :16.42  \n 3rd Qu.: 156   3rd Qu.:2.831      3rd Qu.:0.5090   3rd Qu.:17.21  \n Max.   :1200   Max.   :4.334      Max.   :0.9800   Max.   :23.82  \n                                                                   \n  net_height_m    area_swept_km2      performance    \n Min.   : 0.000   Min.   :0.002314   Min.   :0.0000  \n 1st Qu.: 2.399   1st Qu.:0.024251   1st Qu.:0.0000  \n Median : 5.886   Median :0.039562   Median :0.0000  \n Mean   : 4.841   Mean   :0.036404   Mean   :0.2777  \n 3rd Qu.: 6.799   3rd Qu.:0.047326   3rd Qu.:0.0000  \n Max.   :11.038   Max.   :0.077795   Max.   :7.0000  \n NA's   :3269                                        \n```\n\n\n:::\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 33334; cols: 27\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_haul_api <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat, 3)\n```\n:::\n\n::: {.cell tbl-cap='First few rows of haul data. '}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-7212a04a{}.cl-72011852{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-72011870{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7207cc10{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7207cc24{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-720805c2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-720805cc{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-720805d6{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-720805d7{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-720805e0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-720805ea{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-7212a04a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">year</span></p></th><th class=\"cl-720805cc\"><p class=\"cl-7207cc24\"><span class=\"cl-72011852\">srvy</span></p></th><th class=\"cl-720805cc\"><p class=\"cl-7207cc24\"><span class=\"cl-72011852\">survey</span></p></th><th class=\"cl-720805cc\"><p class=\"cl-7207cc24\"><span class=\"cl-72011852\">survey_name</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">survey_definition_id</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">cruise</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">cruisejoin</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">hauljoin</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">haul</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">stratum</span></p></th><th class=\"cl-720805cc\"><p class=\"cl-7207cc24\"><span class=\"cl-72011852\">station</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">vessel_id</span></p></th><th class=\"cl-720805cc\"><p class=\"cl-7207cc24\"><span class=\"cl-72011852\">vessel_name</span></p></th><th class=\"cl-720805cc\"><p class=\"cl-7207cc24\"><span class=\"cl-72011852\">date_time</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">latitude_dd_start</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">longitude_dd_start</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">latitude_dd_end</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">longitude_dd_end</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">bottom_temperature_c</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">surface_temperature_c</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">depth_m</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">distance_fished_km</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">duration_hr</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">net_width_m</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">net_height_m</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">area_swept_km2</span></p></th><th class=\"cl-720805c2\"><p class=\"cl-7207cc10\"><span class=\"cl-72011852\">performance</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2015</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">EBS</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">eastern Bering Sea</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">98</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">201501</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-698</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-14,399</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">133</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">41</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">M-20</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">162</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">ALASKA KNIGHT</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">2015-07-04T11:01:28Z</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">58.97713</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-169.8382</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">59.00117</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-169.8264</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.0</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">5.2</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">64</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2.758</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.518</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">16.880</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2.085</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.046555</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2005</span></p></td><td class=\"cl-720805ea\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">EBS</span></p></td><td class=\"cl-720805ea\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">eastern Bering Sea</span></p></td><td class=\"cl-720805ea\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">98</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">200501</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-612</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-13,759</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">71</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">31</span></p></td><td class=\"cl-720805ea\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">F-04</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">88</span></p></td><td class=\"cl-720805ea\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">ARCTURUS</span></p></td><td class=\"cl-720805ea\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">2005-06-19T17:23:13Z</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">56.65513</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-165.8663</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">56.68046</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-165.8501</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">3.7</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">7.6</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">79</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2.989</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.521</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">17.185</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2.223</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.051366</span></p></td><td class=\"cl-720805e0\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2014</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">EBS</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">eastern Bering Sea</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">98</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">201401</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-689</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-11,934</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">89</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">41</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">M-19</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">162</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">ALASKA KNIGHT</span></p></td><td class=\"cl-720805d7\"><p class=\"cl-7207cc24\"><span class=\"cl-72011870\">2014-07-01T15:08:44Z</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">58.98618</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-169.1757</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">59.01007</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">-169.1831</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">1.0</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">6.4</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">54</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2.688</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.500</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">15.756</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">2.130</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0.042352</span></p></td><td class=\"cl-720805d6\"><p class=\"cl-7207cc10\"><span class=\"cl-72011870\">0</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Catch data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_catch <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/'\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# api_link_catch <- 'https://dev-apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/' # test\n```\n:::\n\n\n**Load first 25 rows of data:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = api_link_catch)\n# res ## Test connection\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(data$items)[1], \"; cols: \", dim(data$items)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 25; cols: 8\"\n```\n\n\n:::\n:::\n\n\n**Load all data:**\n\nSince the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by `offsetting` to the next 10,000 rows (as is shown here). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame()\nfor (i in seq(0, 1000000, 10000)){\n  ## find how many iterations it takes to cycle through the data\n  print(i)\n  ## query the API link\n  res <- httr::GET(url = paste0(api_link_catch, \"?offset=\",i,\"&limit=10000\"))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  \n  ## if there are no data, stop the loop\n  if (is.null(nrow(data$items))) {\n    break\n  }\n  \n  ## bind sub-pull to dat data.frame\n  dat <- dplyr::bind_rows(dat, \n                          data$items %>%\n                            dplyr::select(-links)) # necessary for API accounting, but not part of the dataset)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n[1] 10000\n[1] 20000\n[1] 30000\n[1] 40000\n[1] 50000\n[1] 60000\n[1] 70000\n[1] 80000\n[1] 90000\n[1] 100000\n[1] 110000\n[1] 120000\n[1] 130000\n[1] 140000\n[1] 150000\n[1] 160000\n[1] 170000\n[1] 180000\n[1] 190000\n[1] 200000\n[1] 210000\n[1] 220000\n[1] 230000\n[1] 240000\n[1] 250000\n[1] 260000\n[1] 270000\n[1] 280000\n[1] 290000\n[1] 300000\n[1] 310000\n[1] 320000\n[1] 330000\n[1] 340000\n[1] 350000\n[1] 360000\n[1] 370000\n[1] 380000\n[1] 390000\n[1] 400000\n[1] 410000\n[1] 420000\n[1] 430000\n[1] 440000\n[1] 450000\n[1] 460000\n[1] 470000\n[1] 480000\n[1] 490000\n[1] 500000\n[1] 510000\n[1] 520000\n[1] 530000\n[1] 540000\n[1] 550000\n[1] 560000\n[1] 570000\n[1] 580000\n[1] 590000\n[1] 600000\n[1] 610000\n[1] 620000\n[1] 630000\n[1] 640000\n[1] 650000\n[1] 660000\n[1] 670000\n[1] 680000\n[1] 690000\n[1] 700000\n[1] 710000\n[1] 720000\n[1] 730000\n[1] 740000\n[1] 750000\n[1] 760000\n[1] 770000\n[1] 780000\n[1] 790000\n[1] 800000\n[1] 810000\n[1] 820000\n[1] 830000\n[1] 840000\n[1] 850000\n[1] 860000\n[1] 870000\n[1] 880000\n[1] 890000\n[1] 900000\n[1] 910000\n[1] 920000\n[1] 930000\n[1] 940000\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    hauljoin        species_code     cpue_kgkm2        cpue_nokm2      \n Min.   : -23126   Min.   :    1   Min.   :      0   Min.   :      13  \n 1st Qu.: -13968   1st Qu.:21333   1st Qu.:      5   1st Qu.:      56  \n Median :  -5200   Median :43010   Median :     40   Median :     207  \n Mean   : 286755   Mean   :47620   Mean   :   1146   Mean   :    4379  \n 3rd Qu.: 816166   3rd Qu.:72751   3rd Qu.:    316   3rd Qu.:    1079  \n Max.   :1225635   Max.   :99999   Max.   :3226235   Max.   :21780780  \n                                                     NA's   :118525    \n     count          weight_kg         taxon_confidence  \n Min.   :     1   Min.   :    0.001   Length:939197     \n 1st Qu.:     2   1st Qu.:    0.168   Class :character  \n Median :     7   Median :    1.480   Mode  :character  \n Mean   :   172   Mean   :   38.354                     \n 3rd Qu.:    41   3rd Qu.:   11.700                     \n Max.   :867119   Max.   :18187.700                     \n NA's   :118525                                         \n```\n\n\n:::\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 939197; cols: 7\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_catch_api <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat_catch_api, 3)\n```\n:::\n\n::: {.cell tbl-cap='First few rows of catch data. '}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-377d990c{}.cl-376c758c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-376c7596{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-37724b9c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-37724ba6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-37727e28{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37727e32{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37727e33{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37727e3c{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37727e46{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37727e47{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-377d990c'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-37727e28\"><p class=\"cl-37724b9c\"><span class=\"cl-376c758c\">hauljoin</span></p></th><th class=\"cl-37727e28\"><p class=\"cl-37724b9c\"><span class=\"cl-376c758c\">species_code</span></p></th><th class=\"cl-37727e28\"><p class=\"cl-37724b9c\"><span class=\"cl-376c758c\">cpue_kgkm2</span></p></th><th class=\"cl-37727e28\"><p class=\"cl-37724b9c\"><span class=\"cl-376c758c\">cpue_nokm2</span></p></th><th class=\"cl-37727e28\"><p class=\"cl-37724b9c\"><span class=\"cl-376c758c\">count</span></p></th><th class=\"cl-37727e28\"><p class=\"cl-37724b9c\"><span class=\"cl-376c758c\">weight_kg</span></p></th><th class=\"cl-37727e32\"><p class=\"cl-37724ba6\"><span class=\"cl-376c758c\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">1,180,846</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">10200</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">413.670836</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">1,455.98431</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">34</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">9.660</span></p></td><td class=\"cl-37727e3c\"><p class=\"cl-37724ba6\"><span class=\"cl-376c7596\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-37727e46\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">1,180,867</span></p></td><td class=\"cl-37727e46\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">66120</span></p></td><td class=\"cl-37727e46\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">25.864144</span></p></td><td class=\"cl-37727e46\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">1,363.44531</span></p></td><td class=\"cl-37727e46\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">33</span></p></td><td class=\"cl-37727e46\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">0.626</span></p></td><td class=\"cl-37727e47\"><p class=\"cl-37724ba6\"><span class=\"cl-376c7596\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">1,180,871</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">24200</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">0.794012</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">39.70062</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">1</span></p></td><td class=\"cl-37727e33\"><p class=\"cl-37724b9c\"><span class=\"cl-376c7596\">0.020</span></p></td><td class=\"cl-37727e3c\"><p class=\"cl-37724ba6\"><span class=\"cl-376c7596\">1</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Species data:\n\nSince there are less than 10,000 rows of species data (and the maxim number of rows a user can pull from this API is 10,000 rows in a query), we can simply call `?offset=0&limit=10000` in our query call. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_species <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/'\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = paste0(api_link_species, \"?offset=0&limit=10000\"))\n\n# res ## Test connection\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\ndat <- data$items  %>%\n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  species_code   scientific_name    common_name          id_rank         \n Min.   :    1   Length:1894        Length:1894        Length:1894       \n 1st Qu.:30105   Class :character   Class :character   Class :character  \n Median :70061   Mode  :character   Mode  :character   Mode  :character  \n Mean   :58788                                                           \n 3rd Qu.:80543                                                           \n Max.   :99999                                                           \n                                                                         \n     worms              itis        \n Min.   :     51   Min.   :  46861  \n 1st Qu.: 134194   1st Qu.:  79433  \n Median : 254533   Median : 157165  \n Mean   : 299858   Mean   : 209114  \n 3rd Qu.: 368813   3rd Qu.: 167413  \n Max.   :1699283   Max.   :1206057  \n NA's   :233       NA's   :388      \n```\n\n\n:::\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 1894; cols: 6\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_species_api <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(data$items, 3)\n```\n:::\n\n::: {.cell tbl-cap='First few rows of species data. '}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-3840956a{}.cl-382ec13c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-382ec150{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-383509c0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-383509d4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-383541ec{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38354200{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3835420a{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3835420b{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38354214{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3835421e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-3840956a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-383541ec\"><p class=\"cl-383509c0\"><span class=\"cl-382ec13c\">species_code</span></p></th><th class=\"cl-38354200\"><p class=\"cl-383509d4\"><span class=\"cl-382ec13c\">scientific_name</span></p></th><th class=\"cl-38354200\"><p class=\"cl-383509d4\"><span class=\"cl-382ec13c\">common_name</span></p></th><th class=\"cl-38354200\"><p class=\"cl-383509d4\"><span class=\"cl-382ec13c\">id_rank</span></p></th><th class=\"cl-383541ec\"><p class=\"cl-383509c0\"><span class=\"cl-382ec13c\">worms</span></p></th><th class=\"cl-383541ec\"><p class=\"cl-383509c0\"><span class=\"cl-382ec13c\">itis</span></p></th><th class=\"cl-383541ec\"><p class=\"cl-383509c0\"><span class=\"cl-382ec13c\">links</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">460</span></p></td><td class=\"cl-3835420b\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">Bathyraja trachura</span></p></td><td class=\"cl-3835420b\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">roughtail skate</span></p></td><td class=\"cl-3835420b\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">species</span></p></td><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">271538</span></p></td><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">160942</span></p></td><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">[[data.frame]]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-38354214\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">495</span></p></td><td class=\"cl-3835421e\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">Bathyraja violacea</span></p></td><td class=\"cl-3835421e\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">Okhotsk skate</span></p></td><td class=\"cl-3835421e\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">species</span></p></td><td class=\"cl-38354214\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">271540</span></p></td><td class=\"cl-38354214\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">564249</span></p></td><td class=\"cl-38354214\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">[[data.frame]]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">710</span></p></td><td class=\"cl-3835420b\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">Hydrolagus colliei</span></p></td><td class=\"cl-3835420b\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">spotted ratfish</span></p></td><td class=\"cl-3835420b\"><p class=\"cl-383509d4\"><span class=\"cl-382ec150\">species</span></p></td><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">271406</span></p></td><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">161015</span></p></td><td class=\"cl-3835420a\"><p class=\"cl-383509c0\"><span class=\"cl-382ec150\">[[data.frame]]</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot\n\nIt is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# come up with full combination of what species should be listed for what hauls/surveys\n# for zero-filled data, all species caught in a survey need to have zero or non-zero row entries for a haul\ncomb <- dplyr::full_join(\n  # find all species that have been caught, by survey\n  x = dplyr::left_join(dat_catch_api, dat_haul_api, by = \"hauljoin\") %>%\n    dplyr::select(survey_definition_id, species_code) %>%\n    dplyr::distinct(),\n  # find all haul events (hauljoins), by survey\n  y = dat_haul_api %>%\n    dplyr::select(survey_definition_id, hauljoin) %>%\n    dplyr::distinct(),\n  relationship = \"many-to-many\",\n  by = \"survey_definition_id\"\n) %>% \n  dplyr::select(-survey_definition_id) # redundant\n\nhead(comb, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  species_code hauljoin\n1        10200   -22236\n2        10200   -22190\n3        10200   -20871\n```\n\n\n:::\n\n```{.r .cell-code}\n# Join data to make a full zero-filled CPUE dataset\n\ndat_zerofill_api <- comb %>%\n  # add species data to unique species by survey table\n  dplyr::left_join(dat_species_api) %>% # , \"species_code\"\n  # add haul data\n  dplyr::left_join(dat_haul_api) %>% # , c(\"hauljoin\")\n  # add catch data\n  dplyr::left_join(dat_catch_api) %>% # , c(\"species_code\", \"hauljoin\")\n  # modify zero-filled rows\n  dplyr::mutate(\n    cpue_kgkm2 = ifelse(is.na(cpue_kgkm2), 0, cpue_kgkm2),\n    cpue_nokm2 = ifelse(is.na(cpue_nokm2), 0, cpue_nokm2),\n    count = ifelse(is.na(count), 0, count),\n    weight_kg = ifelse(is.na(weight_kg), 0, weight_kg))\n\n## Find how many rows and columns are in the data pull. \n## Because all of the data have been full joined together, \n## there should be the maximum number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 1894; cols: 6\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dat, 3) %>% \n  flextable::flextable() %>% flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-5bbbba42{}.cl-5ba86dd4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5ba86dfc{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5bb10804{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5bb10818{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5bb14008{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5bb1401c{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5bb14026{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5bb14027{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5bb14030{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5bb1403a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-5bbbba42'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-5bb14008\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dd4\">species_code</span></p></th><th class=\"cl-5bb1401c\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dd4\">scientific_name</span></p></th><th class=\"cl-5bb1401c\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dd4\">common_name</span></p></th><th class=\"cl-5bb1401c\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dd4\">id_rank</span></p></th><th class=\"cl-5bb14008\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dd4\">worms</span></p></th><th class=\"cl-5bb14008\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dd4\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-5bb14026\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">460</span></p></td><td class=\"cl-5bb14027\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">Bathyraja trachura</span></p></td><td class=\"cl-5bb14027\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">roughtail skate</span></p></td><td class=\"cl-5bb14027\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">species</span></p></td><td class=\"cl-5bb14026\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">271,538</span></p></td><td class=\"cl-5bb14026\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">160,942</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-5bb14030\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">495</span></p></td><td class=\"cl-5bb1403a\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">Bathyraja violacea</span></p></td><td class=\"cl-5bb1403a\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">Okhotsk skate</span></p></td><td class=\"cl-5bb1403a\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">species</span></p></td><td class=\"cl-5bb14030\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">271,540</span></p></td><td class=\"cl-5bb14030\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">564,249</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-5bb14026\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">710</span></p></td><td class=\"cl-5bb14027\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">Hydrolagus colliei</span></p></td><td class=\"cl-5bb14027\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">spotted ratfish</span></p></td><td class=\"cl-5bb14027\"><p class=\"cl-5bb10818\"><span class=\"cl-5ba86dfc\">species</span></p></td><td class=\"cl-5bb14026\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">271,406</span></p></td><td class=\"cl-5bb14026\"><p class=\"cl-5bb10804\"><span class=\"cl-5ba86dfc\">161,015</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Visualize CPUE data in distribution map\n\nUsing the zero-filled data from the previous example, we can make a few plots! \n\nHere is some example data of 2023 through 2019 (`year %in% 2019:2023`) eastern and northern Bering Sea (`srvy == c(\"EBS\", \"NBS)`) walleye pollock (`species_code == 21740`). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat0 <- dat_zerofill_api %>% \n  dplyr::filter(year %in% c(2019:2023) & \n                  srvy == c(\"EBS\", \"NBS\") & \n                  species_code == 21740)\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 1894; cols: 6\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dat0, 3) %>% flextable::flextable() %>% flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-5d9a14ee{}.cl-5d878c52{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5d878c66{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5d8e562c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5d8e5636{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5d8e92d6{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5d8e92e0{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5d8e92ea{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5d8e92eb{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5d8e92f4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5d8e92fe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-5d9a14ee'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">species_code</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">hauljoin</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">scientific_name</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">common_name</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">id_rank</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">worms</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">itis</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">year</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">srvy</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">survey</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">survey_name</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">survey_definition_id</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">cruise</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">cruisejoin</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">haul</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">stratum</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">station</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">vessel_id</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">vessel_name</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">date_time</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">latitude_dd_start</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">longitude_dd_start</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">latitude_dd_end</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">longitude_dd_end</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">bottom_temperature_c</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">surface_temperature_c</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">depth_m</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">distance_fished_km</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">duration_hr</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">net_width_m</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">net_height_m</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">area_swept_km2</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">performance</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">cpue_kgkm2</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">cpue_nokm2</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">count</span></p></th><th class=\"cl-5d8e92d6\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c52\">weight_kg</span></p></th><th class=\"cl-5d8e92e0\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c52\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">21,740</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-21,778</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">Gadus chalcogrammus</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">walleye pollock</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">species</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">300,735</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">934,083</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2,022</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">EBS</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">eastern Bering Sea</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">98</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">202,201</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-755</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">196</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">41</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">S-26</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">94</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">VESTERAALEN</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">2022-07-28T16:27:01Z</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">61.00249</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-174.1504</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">60.99662</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-174.2016</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-0.8</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">8.5</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">81</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2.851</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.511</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">17.783</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2.357</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.050699</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">5,103.065</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">11,439.99</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">580</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">258.722</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">21,740</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-21,769</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">Gadus chalcogrammus</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">walleye pollock</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">species</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">300,735</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">934,083</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2,022</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">EBS</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">eastern Bering Sea</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">98</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">202,201</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-756</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">193</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">90</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">U-29</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">162</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">ALASKA KNIGHT</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">2022-07-27T15:43:43Z</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">61.65277</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-176.4648</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">61.67708</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-176.4805</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.0</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">8.2</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">105</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2.828</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.508</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">19.732</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">1.752</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.055802</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">6,025.222</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">13,619.56</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">760</span></p></td><td class=\"cl-5d8e92f4\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">336.220</span></p></td><td class=\"cl-5d8e92fe\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">21,740</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-21,528</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">Gadus chalcogrammus</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">walleye pollock</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">species</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">300,735</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">934,083</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2,022</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">EBS</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">eastern Bering Sea</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">98</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">202,201</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-755</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">135</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">41</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">M-23</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">94</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">VESTERAALEN</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">2022-07-13T07:24:02Z</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">58.97864</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-171.7825</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">59.00292</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">-171.7754</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.1</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">7.9</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">87</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2.729</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.516</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">17.598</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">2.264</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0.048025</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">0</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">4,088.542</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">10,390.43</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">499</span></p></td><td class=\"cl-5d8e92ea\"><p class=\"cl-5d8e562c\"><span class=\"cl-5d878c66\">196.352</span></p></td><td class=\"cl-5d8e92eb\"><p class=\"cl-5d8e5636\"><span class=\"cl-5d878c66\">1</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Plot locations\n\n\n::: {.cell tbl-cap='CPUE (kg/km^2) of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot2::ggplot(data = dat0 %>% dplyr::filter(cpue_kgkm2 != 0), \n                mapping = aes(x = longitude_dd_start, \n                              y = latitude_dd_start, \n                              size = cpue_kgkm2)) + \n  ggplot2::geom_point(alpha = .75) +\n  ggplot2::geom_point(data = dat0 %>% dplyr::filter(cpue_kgkm2 == 0), \n                      color = \"red\", \n                      shape = 17,\n                      alpha = .75,\n                      size = 3) +\n  ggplot2::xlab(\"Longitude *W\") +\n  ggplot2::ylab(\"Latitude *N\") +\n  ggplot2::ggtitle(label = \"Catches of walleye pollock (Weight CPUE; kg/km2)\", \n                   subtitle = \"Eastern Bering Sea bottom trawl survey\") +\n  ggplot2::scale_size_continuous(name = \"Weight (kg)\") + \n  ggplot2::facet_wrap(facets = vars(year)) + \n  ggplot2::theme_bw()\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi-loc-1.png){width=672}\n:::\n:::\n\n\n### Plot inverse-distance weighted modeled product of locations\n\nThis map is constructed using [`akgfmaps`](https://github.com/afsc-gap-products/akgfmaps). To make IDW plots, you must have data from all stations surveyed, even if no fish of interest were found there. \n\n\n::: {.cell tbl-cap='CPUE of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. '}\n\n```{.r .cell-code}\nidw <- akgfmaps::make_idw_stack(\n  x = dat0 %>% \n    dplyr::select(COMMON_NAME = common_name, \n                  CPUE_KGHA = cpue_kgkm2, \n                  LATITUDE = latitude_dd_start, \n                  LONGITUDE = longitude_dd_start, \n                  year), \n  grouping.vars = \"year\", \n  region = \"bs.all\", # Predefined EBS area\n  set.breaks = \"jenks\", # Gets Jenks breaks from classint::classIntervals()\n  in.crs = \"+proj=longlat\", # Set input coordinate reference system\n  out.crs = \"EPSG:3338\", # Set output coordinate reference system\n  extrapolation.grid.type = \"sf\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n```{.r .cell-code}\nshps <- akgfmaps::get_base_layers(\n  select.region = \"bs.all\", \n  include.corners = TRUE, \n  set.crs = \"EPSG:3338\")\n\n# set.breaks <- akgfmaps::eval_plot_breaks(CPUE = dat0$cpue_kgkm2, n.breaks = 5)\n# set.breaks <- as.vector(unlist(set.breaks[set.breaks$style == \"pretty\", -1]))\nset.breaks <- c(0, 50000, 100000, 150000, 200000, 250000)\n\nfigure_print <- ggplot() +\n  # add map of alaska\n  ggplot2::geom_sf(data = shps$akland,\n                   color = NA,\n                   fill = \"grey50\") +\n  # add IDW plots\n  geom_sf(data = idw$extrapolation.stack,\n          mapping = aes(fill = var1.pred),\n          na.rm = FALSE,\n          show.legend = TRUE, \n          color = NA) +\n  ggplot2::scale_fill_manual(\n    name = \"walleye pollock\\nCPUE (kg/km2)\",\n    values =  c(\"gray90\",\n                viridis::viridis(\n                  option = \"mako\",\n                  direction = -1,\n                  n = length(set.breaks)-1,\n                  begin = 0.20,\n                  end = 0.80)),\n    na.translate = FALSE, # Don't use NA\n    drop = FALSE) + \n  # seperate plots by year\n  ggplot2::facet_wrap(facets = vars(year), nrow = 2) + \n  # add survey area\n  ggplot2::geom_sf(\n    data = shps$survey.area, \n    mapping = aes(color = SURVEY, \n                  geometry = geometry), \n    fill = \"transparent\", \n    linewidth = 1, \n    show.legend = FALSE) +\n  ggplot2::scale_color_manual(\n    name = \" \", \n    values = c(\"grey30\", \"grey50\"),\n    breaks = shps$survey.area$SURVEY,\n    labels = shps$survey.area$SRVY) + \n  # lat/lon axis and map bounds\n  ggplot2::scale_x_continuous(name = \"Longitude °W\",\n                              breaks = seq(-180, -150, 5)) +\n  ggplot2::scale_y_continuous(name = \"Latitude °N\",\n                              breaks = seq(50, 65, 5)) + # seq(52, 62, 2)\n  ggplot2::coord_sf(xlim = sf::st_bbox(shps$survey.area)[c(1,3)],\n                    ylim = sf::st_bbox(shps$survey.area)[c(2,4)]) +\n  # add theme aesthetics\n  ggplot2::guides(\n    fill = guide_legend(\n      order = 1,\n      title.position = \"top\",\n      label.position = \"bottom\",\n      title.hjust = 0.5,\n      override.aes = list(color = NA),\n      nrow = 1),\n    color = \"none\") +\n  ggplot2::theme( \n    panel.background = element_rect(fill = \"white\", colour = NA), \n    panel.border = element_rect(fill = NA, colour = \"grey20\"), \n    strip.background = element_blank(), \n    strip.text = element_text(size = 10, face = \"bold\"), \n    legend.text = element_text(size = 9),\n    legend.background = element_rect(colour = \"transparent\", \n                                     fill = \"transparent\"),\n    legend.key = element_rect(colour = \"transparent\", \n                              fill = \"transparent\"),\n    legend.position = \"bottom\", \n    legend.box = \"horizontal\",\n    legend.box.spacing = unit(0, \"pt\"), # reduce space between legend & plot\n    legend.margin=margin(0, 0, 0, 0) )\n\nfigure_print\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi-idw-1.png){width=576}\n:::\n:::\n\n\n# Examples or one species in one survey region in one year\n\n## Ex. Show catch data for 2023 eastern Bering Sea Walleye Pollock\n\nData downloads and joins for just one species, survey, and year are much faster and easier to do. \n\nFirst, because `year` is identified in the haul table, we need to identify all of the hauls (or more specifically, `hauljoin` codes) that were completed in the eastern Bering Sea (`\"srvy\":\"EBS\"`) in 2023 (`\"year\":2023`). \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link\nres <- httr::GET(url = paste0(api_link_haul, '?limit=10000&q={\"year\":2023,\"srvy\":\"EBS\"}'))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content)) \ndat <- data$items %>%\n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n\n## show summary of data to make sure it is subset correctly\nsummary(dat %>% dplyr::mutate(srvy = as.factor(srvy)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year       srvy        survey          survey_name       \n Min.   :2023   EBS:376   Length:376         Length:376        \n 1st Qu.:2023             Class :character   Class :character  \n Median :2023             Mode  :character   Mode  :character  \n Mean   :2023                                                  \n 3rd Qu.:2023                                                  \n Max.   :2023                                                  \n survey_definition_id     cruise         cruisejoin        hauljoin     \n Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  \n 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  \n Median :98           Median :202301   Median :-759.0   Median :-22539  \n Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  \n 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  \n Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  \n      haul           stratum        station            vessel_id    \n Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  \n 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  \n Median :114.00   Median :41.00   Mode  :character   Median :162.0  \n Mean   :114.16   Mean   :39.22                      Mean   :148.3  \n 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  \n Max.   :224.00   Max.   :90.00                      Max.   :162.0  \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:376         Length:376         Min.   :54.66     Min.   :-178.2    \n Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    \n Mode  :character   Mode  :character   Median :58.02     Median :-168.9    \n                                       Mean   :58.26     Mean   :-168.8    \n                                       3rd Qu.:59.50     3rd Qu.:-165.2    \n                                       Max.   :62.01     Max.   :-158.3    \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       \n 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       \n Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       \n Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       \n 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       \n Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  \n 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  \n Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  \n Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  \n 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  \n Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  \n  net_height_m   area_swept_km2     performance    \n Min.   :1.300   Min.   :0.02017   Min.   :0.0000  \n 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000  \n Median :2.064   Median :0.04944   Median :0.0000  \n Mean   :2.107   Mean   :0.04892   Mean   :0.1075  \n 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000  \n Max.   :3.196   Max.   :0.06369   Max.   :6.2200  \n```\n\n\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \n## The eastern Bering Sea survey has 376 stations in it, \n## so this should have a similar number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 376; cols: 27\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_haul_ex <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat_haul_ex, 3)\n```\n:::\n\n::: {.cell tbl-cap='Haul data filtered by `year = 2023` and `SRVY = \\'EBS\\'`. '}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-8a7cb75a{}.cl-8a695638{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8a695642{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8a7074a4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8a7074b8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8a70be50{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a70be5a{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a70be64{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a70be6e{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a70be78{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a70be82{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8a7cb75a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">year</span></p></th><th class=\"cl-8a70be5a\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695638\">srvy</span></p></th><th class=\"cl-8a70be5a\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695638\">survey</span></p></th><th class=\"cl-8a70be5a\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695638\">survey_name</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">survey_definition_id</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">cruise</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">cruisejoin</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">hauljoin</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">haul</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">stratum</span></p></th><th class=\"cl-8a70be5a\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695638\">station</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">vessel_id</span></p></th><th class=\"cl-8a70be5a\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695638\">vessel_name</span></p></th><th class=\"cl-8a70be5a\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695638\">date_time</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">latitude_dd_start</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">longitude_dd_start</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">latitude_dd_end</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">longitude_dd_end</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">bottom_temperature_c</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">surface_temperature_c</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">depth_m</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">distance_fished_km</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">duration_hr</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">net_width_m</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">net_height_m</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">area_swept_km2</span></p></th><th class=\"cl-8a70be50\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695638\">performance</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2023</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">EBS</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">eastern Bering Sea</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">98</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">202301</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-760</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-22,950</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">194</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">41</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">S-26</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">134</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">NORTHWEST EXPLORER</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">2023-07-25T10:20:59Z</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">60.99106</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-174.1873</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">61.01197</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-174.1552</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-0.8</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">9.1</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">83</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2.902</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0.507</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">18.427</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">1.890</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0.053475</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2023</span></p></td><td class=\"cl-8a70be82\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">EBS</span></p></td><td class=\"cl-8a70be82\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">eastern Bering Sea</span></p></td><td class=\"cl-8a70be82\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">98</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">202301</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-760</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-22,621</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">124</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">42</span></p></td><td class=\"cl-8a70be82\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">J-22</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">134</span></p></td><td class=\"cl-8a70be82\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">NORTHWEST EXPLORER</span></p></td><td class=\"cl-8a70be82\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">2023-06-30T08:19:37Z</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">57.98877</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-170.9448</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">57.98921</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-170.9935</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2.3</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">7.1</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">86</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2.887</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0.508</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">17.772</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">1.945</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0.051308</span></p></td><td class=\"cl-8a70be78\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2023</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">EBS</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">eastern Bering Sea</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">98</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">202301</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-759</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-22,710</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">155</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">61</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">G-25</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">162</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">ALASKA KNIGHT</span></p></td><td class=\"cl-8a70be6e\"><p class=\"cl-8a7074b8\"><span class=\"cl-8a695642\">2023-07-08T15:09:48Z</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">56.98981</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-172.6523</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">57.01371</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">-172.6623</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">3.6</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">8.4</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">122</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">2.726</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0.498</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">17.692</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">1.653</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0.048228</span></p></td><td class=\"cl-8a70be64\"><p class=\"cl-8a7074a4\"><span class=\"cl-8a695642\">0</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Identify `species_code` for walleye pollock\n\nIn the catch data, we itemize species catches by `species_code`. To find out which `species_code` to use, you can check variations on the following code. Note that here the word `pollock` is case sensitive. All species `common_name` entries are lower case except for proper nouns (e.g., \"Pacific\"). The notation for finding a string is to use `%` around the phrase. Since `%` is a reserved character in a URL, you have to replace `%` with `%25`. Similarly, `%20` needs to be used in place of a space (e.g., between \"walleye\" and \"pollock\": `\"walleye%20pollock\"}'`).  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link. Use: \nres <- httr::GET(url = paste0(api_link_species, '?q={%22common_name%22:%22walleye%20pollock%22}'))\n# OR\nres <- httr::GET(url = paste0(api_link_species, '?q={\"common_name\":{\"$like\":\"%25pollock%25\"}}'))\n# OR\nres <- httr::GET(url = paste0(api_link_species, '?q={\"common_name\":\"walleye%20pollock\"}'))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content)) \n\n# save outputs for later comparison\ndat_species_ex <- data$items %>% dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_species_ex\n```\n:::\n\n::: {.cell tbl-cap='Walleye pollock species information. '}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-8b0e160a{}.cl-8afe51ca{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8afe51d4{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8b04534a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b04535e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b048c7a{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b048c8e{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b048c98{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b048ca2{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8b0e160a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-8b048c7a\"><p class=\"cl-8b04534a\"><span class=\"cl-8afe51ca\">species_code</span></p></th><th class=\"cl-8b048c8e\"><p class=\"cl-8b04535e\"><span class=\"cl-8afe51ca\">scientific_name</span></p></th><th class=\"cl-8b048c8e\"><p class=\"cl-8b04535e\"><span class=\"cl-8afe51ca\">common_name</span></p></th><th class=\"cl-8b048c8e\"><p class=\"cl-8b04535e\"><span class=\"cl-8afe51ca\">id_rank</span></p></th><th class=\"cl-8b048c7a\"><p class=\"cl-8b04534a\"><span class=\"cl-8afe51ca\">worms</span></p></th><th class=\"cl-8b048c7a\"><p class=\"cl-8b04534a\"><span class=\"cl-8afe51ca\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-8b048c98\"><p class=\"cl-8b04534a\"><span class=\"cl-8afe51d4\">21740</span></p></td><td class=\"cl-8b048ca2\"><p class=\"cl-8b04535e\"><span class=\"cl-8afe51d4\">Gadus chalcogrammus</span></p></td><td class=\"cl-8b048ca2\"><p class=\"cl-8b04535e\"><span class=\"cl-8afe51d4\">walleye pollock</span></p></td><td class=\"cl-8b048ca2\"><p class=\"cl-8b04535e\"><span class=\"cl-8afe51d4\">species</span></p></td><td class=\"cl-8b048c98\"><p class=\"cl-8b04534a\"><span class=\"cl-8afe51d4\">300735</span></p></td><td class=\"cl-8b048c98\"><p class=\"cl-8b04534a\"><span class=\"cl-8afe51d4\">934083</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Then, apply the `hauljoins` and `species_code` to catch query\n\nWe'll use the data from the haul and species table we collected before to select 2023 eastern Bering Sea walleye pollock catch data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link\n# data for all walleye pollock caught in all 2023 eastern Bering Sea survey hauls\ndat <- data.frame()\n# there must be a better way to select multiple values for one parameter, \n# but saving that, we will loop through each hauljoin and collect the data of interest\nfor (i in 1:nrow(dat_haul_ex)) {\n  res <- httr::GET(url = paste0(\n    api_link_catch, \n    '?q={\"species_code\":21740,\"hauljoin\":', dat_haul_ex$hauljoin[i],'}'))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  if (length(data$items) != 0) {\n    dat <- dplyr::bind_rows(\n      dat,\n      data$items %>% \n        dplyr::select(-links)) # necessary for API accounting, but not part of the dataset\n  }\n}\n\n## show summary of data to make sure it is subset correctly\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    hauljoin       species_code     cpue_kgkm2          cpue_nokm2       \n Min.   :-23019   Min.   :21740   Min.   :    10.34   Min.   :    18.26  \n 1st Qu.:-22777   1st Qu.:21740   1st Qu.:  1454.44   1st Qu.:  2278.72  \n Median :-22540   Median :21740   Median :  3286.76   Median :  5875.33  \n Mean   :-22553   Mean   :21740   Mean   :  6364.85   Mean   : 11565.45  \n 3rd Qu.:-22324   3rd Qu.:21740   3rd Qu.:  6956.25   3rd Qu.: 12512.98  \n Max.   :-22110   Max.   :21740   Max.   :148679.68   Max.   :202321.08  \n                                                      NA's   :1          \n     count        weight_kg        taxon_confidence\n Min.   :   1   Min.   :   0.492   Mode:logical    \n 1st Qu.: 114   1st Qu.:  71.560   NA's:374        \n Median : 286   Median : 162.310                   \n Mean   : 574   Mean   : 315.419                   \n 3rd Qu.: 619   3rd Qu.: 350.399                   \n Max.   :9997   Max.   :7346.495                   \n NA's   :1                                         \n```\n\n\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \n## The eastern Bering Sea survey has 376 stations in it, \n## and pollock are often found in throughout the region\n## so this should have a similar number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 374; cols: 7\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_catch_ex <- dat\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat, 3)\n```\n:::\n\n::: {.cell tbl-cap='Catch data for all 2023 eastern Bering Sea Walleye Pollock. '}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-bde59a6c{}.cl-bdd4ca5c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bdd4ca70{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bddb1128{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-bddb49a4{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bddb49b8{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bddb49c2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-bde59a6c'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">hauljoin</span></p></th><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">species_code</span></p></th><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">cpue_kgkm2</span></p></th><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">cpue_nokm2</span></p></th><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">count</span></p></th><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">weight_kg</span></p></th><th class=\"cl-bddb49a4\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca5c\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">-22,950</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">21740</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">2,101.761</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">5,123.875</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">274</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">112.392</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">-22,621</span></p></td><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">21740</span></p></td><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">5,768.932</span></p></td><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">10,563.703</span></p></td><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">542</span></p></td><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">295.991</span></p></td><td class=\"cl-bddb49c2\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">-22,710</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">21740</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">1,840.596</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">2,363.753</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">114</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\">88.769</span></p></td><td class=\"cl-bddb49b8\"><p class=\"cl-bddb1128\"><span class=\"cl-bdd4ca70\"></span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\nFor reference and to help break down the above query, see these other query examples:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# data for haul -22775 (i.e., one specific haul)?\nres <- httr::GET(url = paste0(api_link_catch, \n                              '?offset=',i,'&limit=10000&q={\"hauljoin\":-22775}'))\n\n# data for all walleye pollock (i.e., one species) caught in all years and surveys\nres <- httr::GET(url = paste0(api_link_catch, \n                              '?offset=',i,'&limit=10000&q={\"species_code\":21740}'))\n```\n:::\n\n\n\n\n### Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot\n\nIt is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- dplyr::full_join(\n  dat_haul_ex,\n  dat_catch_ex) %>% \n  dplyr::full_join(\n    dat_species_ex)  %>% \n  # modify zero-filled rows\n  dplyr::mutate(\n    cpue_kgkm2 = ifelse(is.na(cpue_kgkm2), 0, cpue_kgkm2),\n    cpue_nokm2 = ifelse(is.na(cpue_nokm2), 0, cpue_nokm2),\n    count = ifelse(is.na(count), 0, count),\n    weight_kg = ifelse(is.na(weight_kg), 0, weight_kg))\n\n## show summary of data to make sure it is subset correctly\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year          srvy              survey          survey_name       \n Min.   :2023   Length:376         Length:376         Length:376        \n 1st Qu.:2023   Class :character   Class :character   Class :character  \n Median :2023   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2023                                                           \n 3rd Qu.:2023                                                           \n Max.   :2023                                                           \n                                                                        \n survey_definition_id     cruise         cruisejoin        hauljoin     \n Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  \n 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  \n Median :98           Median :202301   Median :-759.0   Median :-22539  \n Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  \n 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  \n Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  \n                                                                        \n      haul           stratum        station            vessel_id    \n Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  \n 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  \n Median :114.00   Median :41.00   Mode  :character   Median :162.0  \n Mean   :114.16   Mean   :39.22                      Mean   :148.3  \n 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  \n Max.   :224.00   Max.   :90.00                      Max.   :162.0  \n                                                                    \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:376         Length:376         Min.   :54.66     Min.   :-178.2    \n Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    \n Mode  :character   Mode  :character   Median :58.02     Median :-168.9    \n                                       Mean   :58.26     Mean   :-168.8    \n                                       3rd Qu.:59.50     3rd Qu.:-165.2    \n                                       Max.   :62.01     Max.   :-158.3    \n                                                                           \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       \n 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       \n Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       \n Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       \n 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       \n Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       \n                                                                            \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  \n 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  \n Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  \n Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  \n 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  \n Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  \n                                                                     \n  net_height_m   area_swept_km2     performance      species_code  \n Min.   :1.300   Min.   :0.02017   Min.   :0.0000   Min.   :21740  \n 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000   1st Qu.:21740  \n Median :2.064   Median :0.04944   Median :0.0000   Median :21740  \n Mean   :2.107   Mean   :0.04892   Mean   :0.1075   Mean   :21740  \n 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000   3rd Qu.:21740  \n Max.   :3.196   Max.   :0.06369   Max.   :6.2200   Max.   :21740  \n                                                    NA's   :2      \n   cpue_kgkm2       cpue_nokm2         count          weight_kg      \n Min.   :     0   Min.   :     0   Min.   :   0.0   Min.   :   0.00  \n 1st Qu.:  1431   1st Qu.:  2238   1st Qu.: 111.5   1st Qu.:  70.64  \n Median :  3273   Median :  5842   Median : 280.0   Median : 161.44  \n Mean   :  6331   Mean   : 11473   Mean   : 569.4   Mean   : 313.74  \n 3rd Qu.:  6946   3rd Qu.: 12345   3rd Qu.: 611.5   3rd Qu.: 349.81  \n Max.   :148680   Max.   :202321   Max.   :9997.0   Max.   :7346.49  \n                                                                     \n taxon_confidence scientific_name    common_name          id_rank         \n Mode:logical     Length:376         Length:376         Length:376        \n NA's:376         Class :character   Class :character   Class :character  \n                  Mode  :character   Mode  :character   Mode  :character  \n                                                                          \n                                                                          \n                                                                          \n                                                                          \n     worms             itis       \n Min.   :300735   Min.   :934083  \n 1st Qu.:300735   1st Qu.:934083  \n Median :300735   Median :934083  \n Mean   :300735   Mean   :934083  \n 3rd Qu.:300735   3rd Qu.:934083  \n Max.   :300735   Max.   :934083  \n NA's   :2        NA's   :2       \n```\n\n\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \n## Because all of the data have been full joined together, \n## there should be the maximum number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 376; cols: 38\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(dat, 3) %>% \n  flextable::flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-be5e2b44{}.cl-be4ca220{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-be52fd1e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be52fd28{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be533c0c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be533c16{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be533c20{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be533c2a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be533c2b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be533c34{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-be5e2b44'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">year</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">srvy</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">survey</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">survey_name</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">survey_definition_id</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">cruise</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">cruisejoin</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">hauljoin</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">haul</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">stratum</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">station</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">vessel_id</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">vessel_name</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">date_time</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">latitude_dd_start</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">longitude_dd_start</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">latitude_dd_end</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">longitude_dd_end</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">bottom_temperature_c</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">surface_temperature_c</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">depth_m</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">distance_fished_km</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">duration_hr</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">net_width_m</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">net_height_m</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">area_swept_km2</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">performance</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">species_code</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">cpue_kgkm2</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">cpue_nokm2</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">count</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">weight_kg</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">taxon_confidence</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">scientific_name</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">common_name</span></p></th><th class=\"cl-be533c16\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">id_rank</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">worms</span></p></th><th class=\"cl-be533c0c\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2,023</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">EBS</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">eastern Bering Sea</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">98</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">202,301</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-760</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-22,950</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">194</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">41</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">S-26</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">134</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">NORTHWEST EXPLORER</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">2023-07-25T10:20:59Z</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">60.99106</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-174.1873</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">61.01197</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-174.1552</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-0.8</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">9.1</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">83</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2.902</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0.507</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">18.427</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">1.890</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0.053475</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">21,740</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2,101.761</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">5,123.875</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">274</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">112.392</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\"></span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">Gadus chalcogrammus</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">walleye pollock</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">species</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">300,735</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">934,083</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2,023</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">EBS</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">eastern Bering Sea</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">98</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">202,301</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-760</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-22,621</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">124</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">42</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">J-22</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">134</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">NORTHWEST EXPLORER</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">2023-06-30T08:19:37Z</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">57.98877</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-170.9448</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">57.98921</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-170.9935</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2.3</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">7.1</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">86</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2.887</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0.508</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">17.772</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">1.945</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0.051308</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">21,740</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">5,768.932</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">10,563.703</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">542</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">295.991</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\"></span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">Gadus chalcogrammus</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">walleye pollock</span></p></td><td class=\"cl-be533c2a\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">species</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">300,735</span></p></td><td class=\"cl-be533c20\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">934,083</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2,023</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">EBS</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">eastern Bering Sea</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">98</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">202,301</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-759</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-22,710</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">155</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">61</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">G-25</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">162</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">ALASKA KNIGHT</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">2023-07-08T15:09:48Z</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">56.98981</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-172.6523</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">57.01371</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">-172.6623</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">3.6</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">8.4</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">122</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2.726</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0.498</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">17.692</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">1.653</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0.048228</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">0</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">21,740</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">1,840.596</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">2,363.753</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">114</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">88.769</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\"></span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">Gadus chalcogrammus</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">walleye pollock</span></p></td><td class=\"cl-be533c34\"><p class=\"cl-be52fd28\"><span class=\"cl-be4ca220\">species</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">300,735</span></p></td><td class=\"cl-be533c2b\"><p class=\"cl-be52fd1e\"><span class=\"cl-be4ca220\">934,083</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Visualize CPUE data in distribution map\n\nUsing the zero-filled data from the previous example, we can make a few plots! \n\n### Plot locations\n\n\n::: {.cell tbl-cap='Amount of catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot2::ggplot(data = dat %>% dplyr::filter(cpue_kgkm2 != 0), \n                mapping = aes(x = longitude_dd_start, \n                              y = latitude_dd_start, \n                              size = cpue_kgkm2)) + \n  ggplot2::geom_point(alpha = .75) +\n  ggplot2::geom_point(data = dat %>% dplyr::filter(cpue_kgkm2 == 0), \n                      color = \"red\", \n                      shape = 17,\n                      alpha = .75,\n                      size = 3) +\n  ggplot2::xlab(\"Longitude *W\") +\n  ggplot2::ylab(\"Latitude *N\") +\n  ggplot2::ggtitle(label = \"Catches of walleye pollock (Weight CPUE; kg/km2)\", \n                   subtitle = \"2023 eastern Bering Sea bottom trawl survey\") +\n  ggplot2::scale_size_continuous(name = \"Weight (kg)\") + \n  ggplot2::theme_bw()\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi1-loc-1.png){width=672}\n:::\n:::\n\n\n### Plot inverse-distance weighted modeled product of locations\n\nThis map is constructed using [`akgfmaps`](https://github.com/afsc-gap-products/akgfmaps)\n\n\n::: {.cell tbl-cap='Amount of catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\n# devtools::install_github(\"afsc-gap-products/akgfmaps\", build_vignettes = TRUE)\nlibrary(akgfmaps)\n\nfigure0 <- akgfmaps::make_idw_map(\n  CPUE_KGHA = dat$cpue_kgkm2, # calculates the same, regardless of units.  \n  LATITUDE = dat$latitude_dd_start, \n  LONGITUDE = dat$longitude_dd_start, \n  region = \"bs.south\", # Predefined EBS area\n  set.breaks = \"jenks\", # Gets Jenks breaks from classint::classIntervals()\n  in.crs = \"+proj=longlat\", # Set input coordinate reference system\n  out.crs = \"EPSG:3338\", # Set output coordinate reference system\n  grid.cell = c(20000, 20000))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n```{.r .cell-code}\nfigure0$plot + # 20x20km grid\n  ggplot2::guides(fill=guide_legend(title = \"walleye pollock\\nCPUE (kg/km2)\"))\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi2-loc-1.png){width=672}\n:::\n:::\n\n\n# Other query examples\n\n## Ex. Combination of year, srvy, stratum\n\nShow haul data where year is less than 1989, srvy = \"EBS\", and stratum is not equal to 81. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(\n  url = paste0(api_link_haul, \n               '?&limit=10000&q={\"year\":{\"$lt\":1989},\"stratum\":{\"$ne\":\"81\"},\"srvy\":\"EBS\"}}'))\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\ndat <- data$items %>% \n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset)\n```\n:::\n\n\n\n\n\n\n",
    "supporting": [
      "foss-api-r_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}