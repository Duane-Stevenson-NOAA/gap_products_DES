{
  "hash": "9bbf6355475860d33a92007842803746",
  "result": {
    "markdown": "---\ntitle: Access API data using R\nnumber-sections: true\nnumber-depth: 3\n---\n\n\n\n\nAKFIN has developed web services (apis) to distribute GAP data. Like the GAP_PRODUCTS schema, these are under active development. These do not require VPN or an oracle connection but they are protected by Oracle authentication, please contact matt.callahan@noaa.gov for information on how to get an api token to use this option.\n\nThe url structure is \"https://apex.psmfc.org/akfin/data_marts/gap_products/gap_[base table name]\" . For example \"https://apex.psmfc.org/akfin/data_marts/gap_products/gap_biomass\" is the base url to get data from the akfin_biomass table. Web services linked to large tables have mandatory parameters to reduce data download size. For example to get agecomp data for Bering Sea pollock in area_id 10 in 2022 you would use \"https://apex.psmfc.org/akfin/data_marts/gap_products/gap_biomass?survey_definition_id=98&area_id=10&species_code=21740&start_year=2022&end_year=2022”.\n\nIf you’re using R to pull data through web services you might find the [akfingapdata](https://github.com/MattCallahan-NOAA/akfingapdata/tree/main) (pronounced akfin-gap-data not ak-eff-ing-app-data) R package helpful.\n\n\n\n::: {.cell}\n\n:::\n\n\n## Ex. Direct database query in R using the (akfingapdata readme)[https://github.com/MattCallahan-NOAA/akfingapdata/blob/main/README.Rmd] R package:\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell tbl-cap='Ex. 2: Load data with {akfingapdata}. '}\n\n:::\n\n## Ex. Direct database query in R using the (akfingapdata readme)[https://github.com/MattCallahan-NOAA/akfingapdata/blob/main/README.Rmd] R package:\n\nSign into akfin with token (need to request token from AKFIN)\n\n\n::: {.cell}\n\n:::\n\n::: {.cell tbl-cap='Ex. 2: Load catch data with {akfingapdata}. '}\n\n```{.r .cell-code}\nakfingapdata::get_gap_catch()[,1:6] %>% \n  head() %>% \n  flextable::flextable() %>%\n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-7ed8f6c2{}.cl-7ecc2078{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7ecc208c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7ed0d4b0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7ed0f4c2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ed0f4cc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ed0f4d6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-7ed8f6c2'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-7ed0f4c2\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc2078\">cruisejoin</span></p></th><th class=\"cl-7ed0f4c2\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc2078\">hauljoin</span></p></th><th class=\"cl-7ed0f4c2\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc2078\">catchjoin</span></p></th><th class=\"cl-7ed0f4c2\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc2078\">species_code</span></p></th><th class=\"cl-7ed0f4c2\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc2078\">weight_kg</span></p></th><th class=\"cl-7ed0f4c2\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc2078\">count</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-611</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-13,518</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-370,848</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">21,740</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">15.560</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">11</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-611</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-13,510</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-370,572</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">21,740</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">166.680</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">138</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-611</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-13,657</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-375,427</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">21,740</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">942.587</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">1,389</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-611</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-13,545</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-371,701</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">21,740</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">1,154.024</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">1,345</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-611</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-13,577</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-372,795</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">21,740</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">963.070</span></p></td><td class=\"cl-7ed0f4cc\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">1,273</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-611</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-13,626</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">-374,397</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">21,740</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">189.590</span></p></td><td class=\"cl-7ed0f4d6\"><p class=\"cl-7ed0d4b0\"><span class=\"cl-7ecc208c\">450</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}